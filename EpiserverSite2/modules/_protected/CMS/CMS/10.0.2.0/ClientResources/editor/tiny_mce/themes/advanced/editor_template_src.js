(function(e){function t(e,t){function n(e){return e.replace(/%(\w+)/g,"")}var i,o,a,l=e.dom,s="";return previewStyles=e.settings.preview_styles,previewStyles===!1?"":(previewStyles||(previewStyles="font-family font-size font-weight text-decoration text-transform color background-color"),i=t.block||t.inline||"span",o=l.create(i),r(t.styles,function(e,t){e=n(e),e&&l.setStyle(o,t,e)}),r(t.attributes,function(e,t){e=n(e),e&&l.setAttrib(o,t,e)}),r(t.classes,function(e){e=n(e),l.hasClass(o,e)||l.addClass(o,e)}),l.setStyles(o,{position:"absolute",left:-65535}),e.getBody().appendChild(o),a=l.getStyle(e.getBody(),"fontSize",!0),a=/px$/.test(a)?parseInt(a,10):0,r(previewStyles.split(" "),function(t){var n=l.getStyle(o,t,!0);if("background-color"!=t||!/transparent|rgba\s*\([^)]+,\s*0\)/.test(n)||(n=l.getStyle(e.getBody(),t,!0),"#ffffff"!=l.toHex(n).toLowerCase())){if("font-size"==t&&/em|%$/.test(n)){if(0===a)return;n=parseFloat(n,10)/(/%$/.test(n)?100:1),n=n*a+"px"}s+=t+":"+n+";"}}),l.remove(o),s)}var n,i=e.DOM,o=e.dom.Event,a=e.extend,r=e.each,l=e.util.Cookie,s=e.explode;e.ThemeManager.requireLangPack("advanced"),e.create("tinymce.themes.AdvancedTheme",{sizes:[8,10,12,14,18,24,36],controls:{bold:["bold_desc","Bold"],italic:["italic_desc","Italic"],underline:["underline_desc","Underline"],strikethrough:["striketrough_desc","Strikethrough"],justifyleft:["justifyleft_desc","JustifyLeft"],justifycenter:["justifycenter_desc","JustifyCenter"],justifyright:["justifyright_desc","JustifyRight"],justifyfull:["justifyfull_desc","JustifyFull"],bullist:["bullist_desc","InsertUnorderedList"],numlist:["numlist_desc","InsertOrderedList"],outdent:["outdent_desc","Outdent"],indent:["indent_desc","Indent"],cut:["cut_desc","Cut"],copy:["copy_desc","Copy"],paste:["paste_desc","Paste"],undo:["undo_desc","Undo"],redo:["redo_desc","Redo"],link:["link_desc","mceLink"],unlink:["unlink_desc","unlink"],image:["image_desc","mceImage"],cleanup:["cleanup_desc","mceCleanup"],help:["help_desc","mceHelp"],code:["code_desc","mceCodeEditor"],hr:["hr_desc","InsertHorizontalRule"],removeformat:["removeformat_desc","RemoveFormat"],sub:["sub_desc","subscript"],sup:["sup_desc","superscript"],forecolor:["forecolor_desc","ForeColor"],forecolorpicker:["forecolor_desc","mceForeColor"],backcolor:["backcolor_desc","HiliteColor"],backcolorpicker:["backcolor_desc","mceBackColor"],charmap:["charmap_desc","mceCharMap"],visualaid:["visualaid_desc","mceToggleVisualAid"],anchor:["anchor_desc","mceInsertAnchor"],newdocument:["newdocument_desc","mceNewDocument"],blockquote:["blockquote_desc","mceBlockQuote"]},stateControls:["bold","italic","underline","strikethrough","bullist","numlist","justifyleft","justifycenter","justifyright","justifyfull","sub","sup","blockquote"],init:function(t,n){var o,l,s,c=this;c.editor=t,c.url=n,c.onResolveName=new e.util.Dispatcher(this),o=t.settings,t.forcedHighContrastMode=t.settings.detect_highcontrast&&c._isHighContrast(),t.settings.skin=t.forcedHighContrastMode?"highcontrast":t.settings.skin,o.theme_advanced_buttons1||(o=a({theme_advanced_buttons1:"bold,italic,underline,strikethrough,|,justifyleft,justifycenter,justifyright,justifyfull,|,styleselect,formatselect",theme_advanced_buttons2:"bullist,numlist,|,outdent,indent,|,undo,redo,|,link,unlink,anchor,image,cleanup,help,code",theme_advanced_buttons3:"hr,removeformat,visualaid,|,sub,sup,|,charmap"},o)),c.settings=o=a({theme_advanced_path:!0,theme_advanced_toolbar_location:"top",theme_advanced_blockformats:"p,address,pre,h1,h2,h3,h4,h5,h6",theme_advanced_toolbar_align:"left",theme_advanced_statusbar_location:"bottom",theme_advanced_fonts:"Andale Mono=andale mono,times;Arial=arial,helvetica,sans-serif;Arial Black=arial black,avant garde;Book Antiqua=book antiqua,palatino;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier;Georgia=georgia,palatino;Helvetica=helvetica;Impact=impact,chicago;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco;Times New Roman=times new roman,times;Trebuchet MS=trebuchet ms,geneva;Verdana=verdana,geneva;Webdings=webdings;Wingdings=wingdings,zapf dingbats",theme_advanced_more_colors:1,theme_advanced_row_height:23,theme_advanced_resize_horizontal:1,theme_advanced_resizing_use_cookie:1,theme_advanced_font_sizes:"1,2,3,4,5,6,7",theme_advanced_font_selector:"span",theme_advanced_show_current_color:0,readonly:t.settings.readonly},o),o.font_size_style_values||(o.font_size_style_values="8pt,10pt,12pt,14pt,18pt,24pt,36pt"),e.is(o.theme_advanced_font_sizes,"string")&&(o.font_size_style_values=e.explode(o.font_size_style_values),o.font_size_classes=e.explode(o.font_size_classes||""),s={},t.settings.theme_advanced_font_sizes=o.theme_advanced_font_sizes,r(t.getParam("theme_advanced_font_sizes","","hash"),function(e,t){var n;t==e&&e>=1&&7>=e&&(t=e+" ("+c.sizes[e-1]+"pt)",n=o.font_size_classes[e-1],e=o.font_size_style_values[e-1]||c.sizes[e-1]+"pt"),/^\s*\./.test(e)&&(n=e.replace(/\./g,"")),s[t]=n?{"class":n}:{fontSize:e}}),o.theme_advanced_font_sizes=s),(l=o.theme_advanced_path_location)&&"none"!=l&&(o.theme_advanced_statusbar_location=o.theme_advanced_path_location),"none"==o.theme_advanced_statusbar_location&&(o.theme_advanced_statusbar_location=0),t.settings.content_css!==!1&&t.contentCSS.push(t.baseURI.toAbsolute(n+"/skins/"+t.settings.skin+"/content.css")),t.onInit.add(function(){t.settings.readonly||(t.onNodeChange.add(c._nodeChanged,c),t.onKeyUp.add(c._updateUndoStatus,c),t.onMouseUp.add(c._updateUndoStatus,c),t.dom.bind(t.dom.getRoot(),"dragend",function(){c._updateUndoStatus(t)}))}),t.onSetProgressState.add(function(e,t,n){var o,a,r=e.id;t?c.progressTimer=setTimeout(function(){o=e.getContainer(),o=o.insertBefore(i.create("DIV",{style:"position:relative"}),o.firstChild),a=i.get(e.id+"_tbl"),i.add(o,"div",{id:r+"_blocker","class":"mceBlocker",style:{width:a.clientWidth+2,height:a.clientHeight+2}}),i.add(o,"div",{id:r+"_progress","class":"mceProgress",style:{left:a.clientWidth/2,top:a.clientHeight/2}})},n||0):(i.remove(r+"_blocker"),i.remove(r+"_progress"),clearTimeout(c.progressTimer))}),i.loadCSS(o.editor_css?t.documentBaseURI.toAbsolute(o.editor_css):n+"/skins/"+t.settings.skin+"/ui.css"),o.skin_variant&&i.loadCSS(n+"/skins/"+t.settings.skin+"/ui_"+o.skin_variant+".css")},_isHighContrast:function(){var e,t=i.add(i.getRoot(),"div",{style:"background-color: rgb(171,239,86);"});return e=(i.getStyle(t,"background-color",!0)+"").toLowerCase().replace(/ /g,""),i.remove(t),"rgb(171,239,86)"!=e&&"#abef56"!=e},createControl:function(e,t){var n,i;if(i=t.createControl(e))return i;switch(e){case"styleselect":return this._createStyleSelect();case"formatselect":return this._createBlockFormats();case"fontselect":return this._createFontSelect();case"fontsizeselect":return this._createFontSizeSelect();case"forecolor":return this._createForeColorMenu();case"backcolor":return this._createBackColorMenu()}return(n=this.controls[e])?t.createButton(e,{title:"advanced."+n[0],cmd:n[1],ui:n[2],value:n[3]}):void 0},execCommand:function(e,t,n){var i=this["_"+e];return i?(i.call(this,t,n),!0):!1},_importClasses:function(){var e=this.editor,n=e.controlManager.get("styleselect");0==n.getLength()&&r(e.dom.getClasses(),function(i,o){var a,r="style_"+o;a={inline:"span",attributes:{"class":i["class"]},selector:"*"},e.formatter.register(r,a),n.add(i["class"],r,{style:function(){return t(e,a)}})})},_createStyleSelect:function(){var n,i=this,a=i.editor,l=a.controlManager;return n=l.createListBox("styleselect",{title:"advanced.style_select",onselect:function(t){var i,o,l=[];return r(n.items,function(e){l.push(e.value)}),a.focus(),a.undoManager.add(),i=a.formatter.matchAll(l),e.each(i,function(e){t&&e!=t||(e&&a.formatter.remove(e),o=!0)}),o||a.formatter.apply(t),a.undoManager.add(),a.nodeChanged(),!1}}),a.onPreInit.add(function(){var e=0,o=a.getParam("style_formats");o?r(o,function(i){var o,l=0;r(i,function(){l++}),l>1?(o=i.name=i.name||"style_"+e++,a.formatter.register(o,i),n.add(i.title,o,{style:function(){return t(a,i)}})):n.add(i.title)}):r(a.getParam("theme_advanced_styles","","hash"),function(o,r){var l,s;o&&(l="style_"+e++,s={inline:"span",classes:o,selector:"*"},a.formatter.register(l,s),n.add(i.editor.translate(r),l,{style:function(){return t(a,s)}}))})}),0==n.getLength()&&n.onPostRender.add(function(e,t){n.NativeListBox?o.add(t.id,"focus",i._importClasses,i):(o.add(t.id+"_text","focus",i._importClasses,i),o.add(t.id+"_text","mousedown",i._importClasses,i),o.add(t.id+"_open","focus",i._importClasses,i),o.add(t.id+"_open","mousedown",i._importClasses,i))}),n},_createFontSelect:function(){var e,t=this,n=t.editor;return e=n.controlManager.createListBox("fontselect",{title:"advanced.fontdefault",onselect:function(t){var i=e.items[e.selectedIndex];return!t&&i?(n.execCommand("FontName",!1,i.value),void 0):(n.execCommand("FontName",!1,t),e.select(function(e){return t==e}),i&&i.value==t&&e.select(null),!1)}}),e&&r(n.getParam("theme_advanced_fonts",t.settings.theme_advanced_fonts,"hash"),function(t,i){e.add(n.translate(i),t,{style:-1==t.indexOf("dings")?"font-family:"+t:""})}),e},_createFontSizeSelect:function(){var e,t=this,n=t.editor,i=0;return e=n.controlManager.createListBox("fontsizeselect",{title:"advanced.font_size",onselect:function(t){var i=e.items[e.selectedIndex];return!t&&i?(i=i.value,i["class"]?(n.formatter.toggle("fontsize_class",{value:i["class"]}),n.undoManager.add(),n.nodeChanged()):n.execCommand("FontSize",!1,i.fontSize),void 0):(t["class"]?(n.focus(),n.undoManager.add(),n.formatter.toggle("fontsize_class",{value:t["class"]}),n.undoManager.add(),n.nodeChanged()):n.execCommand("FontSize",!1,t.fontSize),e.select(function(e){return t==e}),i&&(i.value.fontSize==t.fontSize||i.value["class"]&&i.value["class"]==t["class"])&&e.select(null),!1)}}),e&&r(t.settings.theme_advanced_font_sizes,function(n,o){var a=n.fontSize;a>=1&&7>=a&&(a=t.sizes[parseInt(a)-1]+"pt"),e.add(o,n,{style:"font-size:"+a,"class":"mceFontSize"+i++ +(" "+(n["class"]||""))})}),e},_createBlockFormats:function(){var e,n={p:"advanced.paragraph",address:"advanced.address",pre:"advanced.pre",h1:"advanced.h1",h2:"advanced.h2",h3:"advanced.h3",h4:"advanced.h4",h5:"advanced.h5",h6:"advanced.h6",div:"advanced.div",blockquote:"advanced.blockquote",code:"advanced.code",dt:"advanced.dt",dd:"advanced.dd",samp:"advanced.samp"},i=this;return e=i.editor.controlManager.createListBox("formatselect",{title:"advanced.block",onselect:function(e){return i.editor.execCommand("FormatBlock",!1,e),!1}}),e&&r(i.editor.getParam("theme_advanced_blockformats",i.settings.theme_advanced_blockformats,"hash"),function(o,a){e.add(i.editor.translate(a!=o?a:n[o]),o,{"class":"mce_formatPreview mce_"+o,style:function(){return t(i.editor,{block:o})}})}),e},_createForeColorMenu:function(){var e,t,n=this,i=n.settings,o={};return i.theme_advanced_more_colors&&(o.more_colors_func=function(){n._mceColorPicker(0,{color:e.value,func:function(t){e.setColor(t)}})}),(t=i.theme_advanced_text_colors)&&(o.colors=t),i.theme_advanced_default_foreground_color&&(o.default_color=i.theme_advanced_default_foreground_color),o.title="advanced.forecolor_desc",o.cmd="ForeColor",o.scope=this,e=n.editor.controlManager.createColorSplitButton("forecolor",o)},_createBackColorMenu:function(){var e,t,n=this,i=n.settings,o={};return i.theme_advanced_more_colors&&(o.more_colors_func=function(){n._mceColorPicker(0,{color:e.value,func:function(t){e.setColor(t)}})}),(t=i.theme_advanced_background_colors)&&(o.colors=t),i.theme_advanced_default_background_color&&(o.default_color=i.theme_advanced_default_background_color),o.title="advanced.backcolor_desc",o.cmd="HiliteColor",o.scope=this,e=n.editor.controlManager.createColorSplitButton("backcolor",o)},renderUI:function(t){var n,a,l,s,c,d,u=this,m=u.editor,g=u.settings;switch(m.settings&&(m.settings.aria_label=g.aria_label+m.getLang("advanced.help_shortcut")),n=c=i.create("span",{role:"application","aria-labelledby":m.id+"_voice",id:m.id+"_parent","class":"mceEditor "+m.settings.skin+"Skin"+(g.skin_variant?" "+m.settings.skin+"Skin"+u._ufirst(g.skin_variant):"")+("rtl"==m.settings.directionality?" mceRtl":"")}),i.add(n,"span",{"class":"mceVoiceLabel",style:"display:none;",id:m.id+"_voice"},g.aria_label),i.boxModel||(n=i.add(n,"div",{"class":"mceOldBoxModel"})),n=s=i.add(n,"table",{role:"presentation",id:m.id+"_tbl","class":"mceLayout",cellSpacing:0,cellPadding:0}),n=l=i.add(n,"tbody"),(g.theme_advanced_layout_manager||"").toLowerCase()){case"rowlayout":a=u._rowLayout(g,l,t);break;case"customlayout":a=m.execCallback("theme_advanced_custom_layout",g,l,t,c);break;default:a=u._simpleLayout(g,l,t,c)}return n=t.targetNode,d=s.rows,i.addClass(d[0],"mceFirst"),i.addClass(d[d.length-1],"mceLast"),r(i.select("tr",l),function(e){i.addClass(e.firstChild,"mceFirst"),i.addClass(e.childNodes[e.childNodes.length-1],"mceLast")}),i.get(g.theme_advanced_toolbar_container)?i.get(g.theme_advanced_toolbar_container).appendChild(c):i.insertAfter(c,n),o.add(m.id+"_path_row","click",function(e){return e=e.target,"A"==e.nodeName?(u._sel(e.className.replace(/^.*mcePath_([0-9]+).*$/,"$1")),!1):void 0}),m.getParam("accessibility_focus")||o.add(i.add(c,"a",{href:"#"},"<!-- IE -->"),"focus",function(){tinyMCE.get(m.id).focus()}),"external"==g.theme_advanced_toolbar_location&&(t.deltaHeight=0),u.deltaHeight=t.deltaHeight,t.targetNode=null,m.onKeyDown.add(function(t,n){var a=121,r=122;if(n.altKey){if(n.keyCode===a)return e.isWebKit&&window.focus(),u.toolbarGroup.focus(),o.cancel(n);if(n.keyCode===r)return i.get(t.id+"_path_row").focus(),o.cancel(n)}}),m.addShortcut("alt+0","","mceShortcuts",u),{iframeContainer:a,editorContainer:m.id+"_parent",sizeContainer:s,deltaHeight:t.deltaHeight}},getInfo:function(){return{longname:"Advanced theme",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",version:e.majorVersion+"."+e.minorVersion}},resizeBy:function(e,t){var n=i.get(this.editor.id+"_ifr");this.resizeTo(n.clientWidth+e,n.clientHeight+t)},resizeTo:function(e,t,n){var o=this.editor,a=this.settings,r=i.get(o.id+"_tbl"),s=i.get(o.id+"_ifr");e=Math.max(a.theme_advanced_resizing_min_width||100,e),t=Math.max(a.theme_advanced_resizing_min_height||100,t),e=Math.min(a.theme_advanced_resizing_max_width||65535,e),t=Math.min(a.theme_advanced_resizing_max_height||65535,t),i.setStyle(r,"height",""),i.setStyle(s,"height",t),a.theme_advanced_resize_horizontal&&(i.setStyle(r,"width",""),i.setStyle(s,"width",e),r.clientWidth>e&&(e=r.clientWidth,i.setStyle(s,"width",r.clientWidth))),n&&a.theme_advanced_resizing_use_cookie&&l.setHash("TinyMCE_"+o.id+"_size",{cw:e,ch:t})},destroy:function(){var e=this.editor.id;o.clear(e+"_resize"),o.clear(e+"_path_row"),o.clear(e+"_external_close")},_simpleLayout:function(e,t,a,r){var l,s,c,d,u=this,m=u.editor,g=e.theme_advanced_toolbar_location,p=e.theme_advanced_statusbar_location;return e.readonly?(l=i.add(t,"tr"),l=s=i.add(l,"td",{"class":"mceIframeContainer"}),s):("top"==g&&u._addToolbars(t,a),"external"==g&&(l=d=i.create("div",{style:"position:relative"}),l=i.add(l,"div",{id:m.id+"_external","class":"mceExternalToolbar"}),i.add(l,"a",{id:m.id+"_external_close",href:"javascript:;","class":"mceExternalClose"}),l=i.add(l,"table",{id:m.id+"_tblext",cellSpacing:0,cellPadding:0}),c=i.add(l,"tbody"),"mceOldBoxModel"==r.firstChild.className?r.firstChild.appendChild(d):r.insertBefore(d,r.firstChild),u._addToolbars(c,a),m.onMouseUp.add(function(){var e=i.get(m.id+"_external");i.show(e),i.hide(n);var t=o.add(m.id+"_external_close","click",function(){return i.hide(m.id+"_external"),o.remove(m.id+"_external_close","click",t),!1});i.show(e),i.setStyle(e,"top",0-i.getRect(m.id+"_tblext").h-1),i.hide(e),i.show(e),e.style.filter="",n=m.id+"_external",e=null})),"top"==p&&u._addStatusBar(t,a),e.theme_advanced_toolbar_container||(l=i.add(t,"tr"),l=s=i.add(l,"td",{"class":"mceIframeContainer"})),"bottom"==g&&u._addToolbars(t,a),"bottom"==p&&u._addStatusBar(t,a),s)},_rowLayout:function(e,t,n){var o,a,l,c,d,u,m=this,g=m.editor,p=g.controlManager;return o=e.theme_advanced_containers_default_class||"",a=e.theme_advanced_containers_default_align||"center",r(s(e.theme_advanced_containers||""),function(r,s){var g=e["theme_advanced_container_"+r]||"";switch(r.toLowerCase()){case"mceeditor":l=i.add(t,"tr"),l=c=i.add(l,"td",{"class":"mceIframeContainer"});break;case"mceelementpath":m._addStatusBar(t,n);break;default:u=(e["theme_advanced_container_"+r+"_align"]||a).toLowerCase(),u="mce"+m._ufirst(u),l=i.add(i.add(t,"tr"),"td",{"class":"mceToolbar "+(e["theme_advanced_container_"+r+"_class"]||o)+" "+u||a}),d=p.createToolbar("toolbar"+s),m._addControls(g,d),i.setHTML(l,d.renderHTML()),n.deltaHeight-=e.theme_advanced_row_height}}),c},_addControls:function(e,t){var n,i=this,o=i.settings,a=i.editor.controlManager;o.theme_advanced_disable&&!i._disabled?(n={},r(s(o.theme_advanced_disable),function(e){n[e]=1}),i._disabled=n):n=i._disabled,r(s(e),function(e){var o;if(!n||!n[e]){if("tablecontrols"==e)return r(["table","|","row_props","cell_props","|","row_before","row_after","delete_row","|","col_before","col_after","delete_col","|","split_cells","merge_cells"],function(e){e=i.createControl(e,a),e&&t.add(e)}),void 0;o=i.createControl(e,a),o&&t.add(o)}})},_addToolbars:function(e,t){var n,o,a,r,l,s,c=this,d=c.editor,u=c.settings,m=d.controlManager,g=[],p=!1;for(s=m.createToolbarGroup("toolbargroup",{name:d.getLang("advanced.toolbar"),tab_focus_toolbar:d.getParam("theme_advanced_tab_focus_toolbar")}),c.toolbarGroup=s,l=u.theme_advanced_toolbar_align.toLowerCase(),l="mce"+c._ufirst(l),r=i.add(i.add(e,"tr",{role:"presentation"}),"td",{"class":"mceToolbar "+l,role:"toolbar"}),n=1;a=u["theme_advanced_buttons"+n];n++)p=!0,o=m.createToolbar("toolbar"+n,{"class":"mceToolbarRow"+n}),u["theme_advanced_buttons"+n+"_add"]&&(a+=","+u["theme_advanced_buttons"+n+"_add"]),u["theme_advanced_buttons"+n+"_add_before"]&&(a=u["theme_advanced_buttons"+n+"_add_before"]+","+a),c._addControls(a,o),s.add(o),t.deltaHeight-=u.theme_advanced_row_height;p||(t.deltaHeight-=u.theme_advanced_row_height),g.push(s.renderHTML()),g.push(i.createHTML("a",{href:"#",accesskey:"z",title:d.getLang("advanced.toolbar_focus"),onfocus:"tinyMCE.getInstanceById('"+d.id+"').focus();"},"<!-- IE -->")),i.setHTML(r,g.join(""))},_addStatusBar:function(e,t){var n,a,r=this,s=r.editor,c=r.settings;n=i.add(e,"tr"),n=a=i.add(n,"td",{"class":"mceStatusbar"}),n=i.add(n,"div",{id:s.id+"_path_row",role:"group","aria-labelledby":s.id+"_path_voice"}),c.theme_advanced_path?(i.add(n,"span",{id:s.id+"_path_voice"},s.translate("advanced.path")),i.add(n,"span",{},": ")):i.add(n,"span",{},"&#160;"),c.theme_advanced_resizing&&(i.add(a,"a",{id:s.id+"_resize",href:"javascript:;",onclick:"return false;","class":"mceResize",tabIndex:"-1"}),c.theme_advanced_resizing_use_cookie&&s.onPostRender.add(function(){var e=l.getHash("TinyMCE_"+s.id+"_size");i.get(s.id+"_tbl"),e&&r.resizeTo(e.cw,e.ch)}),s.onPostRender.add(function(){o.add(s.id+"_resize","click",function(e){e.preventDefault()}),o.add(s.id+"_resize","mousedown",function(e){function t(e){e.preventDefault(),h=g+(e.screenX-u),f=p+(e.screenY-m),r.resizeTo(h,f)}function n(e){o.remove(i.doc,"mousemove",a),o.remove(s.getDoc(),"mousemove",l),o.remove(i.doc,"mouseup",c),o.remove(s.getDoc(),"mouseup",d),h=g+(e.screenX-u),f=p+(e.screenY-m),r.resizeTo(h,f,!0),s.nodeChanged()}var a,l,c,d,u,m,g,p,h,f,_;e.preventDefault(),u=e.screenX,m=e.screenY,_=i.get(r.editor.id+"_ifr"),g=h=_.clientWidth,p=f=_.clientHeight,a=o.add(i.doc,"mousemove",t),l=o.add(s.getDoc(),"mousemove",t),c=o.add(i.doc,"mouseup",n),d=o.add(s.getDoc(),"mouseup",n)})})),t.deltaHeight-=21,n=e=null},_updateUndoStatus:function(e){var t=e.controlManager,n=e.undoManager;t.setDisabled("undo",!n.hasUndo()&&!n.typing),t.setDisabled("redo",!n.hasRedo())},_nodeChanged:function(t,n,o,a,l){function s(e){var t,n=l.parents,i=e;for("string"==typeof e&&(i=function(t){return t.nodeName==e}),t=0;n.length>t;t++)if(i(n[t]))return n[t]}function c(e,t){(m=n.get(e))&&(t||(t=m.settings.default_color),t!==m.value&&m.displayColor(t))}function c(e,t){(m=n.get(e))&&(t||(t=m.settings.default_color),t!==m.value&&m.displayColor(t))}var d,u,m,g,p,h,f,_,y,v,b=this,w=0,C=b.settings;e.each(b.stateControls,function(e){n.setActive(e,t.queryCommandState(b.controls[e][1]))}),n.setActive("visualaid",t.hasVisual),b._updateUndoStatus(t),n.setDisabled("outdent",!t.queryCommandState("Outdent")),d=s("A"),(m=n.get("link"))&&(m.setDisabled(!d&&a||d&&!d.href),m.setActive(!!d&&!d.name&&!d.id)),(m=n.get("unlink"))&&(m.setDisabled(!d&&a),m.setActive(!!d&&!d.name&&!d.id)),(m=n.get("anchor"))&&m.setActive(!a&&!!d&&(d.name||d.id&&!d.href)),d=s("IMG"),(m=n.get("image"))&&m.setActive(!a&&!!d&&-1==o.className.indexOf("mceItem")),(m=n.get("styleselect"))&&(b._importClasses(),y=[],r(m.items,function(e){y.push(e.value)}),v=t.formatter.matchAll(y),m.select(v[0]),e.each(v,function(e,t){t>0&&m.mark(e)})),(m=n.get("formatselect"))&&(d=s(t.dom.isBlock),d&&m.select(d.nodeName.toLowerCase())),s(function(e){return"SPAN"===e.nodeName&&!g&&e.className&&(g=e.className),t.dom.is(e,C.theme_advanced_font_selector)&&(!p&&e.style.fontSize&&(p=e.style.fontSize),!h&&e.style.fontFamily&&(h=e.style.fontFamily.replace(/[\"\']+/g,"").replace(/^([^,]+).*/,"$1").toLowerCase()),!f&&e.style.color&&(f=e.style.color),!_&&e.style.backgroundColor&&(_=e.style.backgroundColor)),!1}),(m=n.get("fontselect"))&&m.select(function(e){return e.replace(/^([^,]+).*/,"$1").toLowerCase()==h}),(m=n.get("fontsizeselect"))&&(!C.theme_advanced_runtime_fontsize||p||g||(p=t.dom.getStyle(o,"fontSize",!0)),m.select(function(e){return e.fontSize&&e.fontSize===p?!0:e["class"]&&e["class"]===g?!0:void 0})),C.theme_advanced_show_current_color&&(c("forecolor",f),c("backcolor",_)),C.theme_advanced_show_current_color&&(c("forecolor",f),c("backcolor",_)),C.theme_advanced_path&&C.theme_advanced_statusbar_location&&(d=i.get(t.id+"_path")||i.add(t.id+"_path_row","span",{id:t.id+"_path"}),b.statusKeyboardNavigation&&(b.statusKeyboardNavigation.destroy(),b.statusKeyboardNavigation=null),i.setHTML(d,""),s(function(n){var o,a=n.nodeName.toLowerCase(),r="";if(!(1!=n.nodeType||"br"===a||n.getAttribute("data-mce-bogus")||i.hasClass(n,"mceItemHidden")||i.hasClass(n,"mceItemRemoved"))){switch(e.isIE&&"HTML"!==n.scopeName&&n.scopeName&&(a=n.scopeName+":"+a),a=a.replace(/mce\:/g,"")){case"b":a="strong";break;case"i":a="em";break;case"img":(u=i.getAttrib(n,"src"))&&(r+="src: "+u+" ");break;case"a":(u=i.getAttrib(n,"name"))&&(r+="name: "+u+" ",a+="#"+u),(u=i.getAttrib(n,"href"))&&(r+="href: "+u+" ");break;case"font":(u=i.getAttrib(n,"face"))&&(r+="font: "+u+" "),(u=i.getAttrib(n,"size"))&&(r+="size: "+u+" "),(u=i.getAttrib(n,"color"))&&(r+="color: "+u+" ");break;case"span":(u=i.getAttrib(n,"style"))&&(r+="style: "+u+" ")}(u=i.getAttrib(n,"id"))&&(r+="id: "+u+" "),(u=n.className)&&(u=u.replace(/\b\s*(webkit|mce|Apple-)\w+\s*\b/g,""),u&&(r+="class: "+u+" ",(t.dom.isBlock(n)||"img"==a||"span"==a)&&(a+="."+u))),a=a.replace(/(html:)/g,""),a={name:a,node:n,title:r},b.onResolveName.dispatch(b,a),r=a.title,a=a.name,o=i.create("a",{href:"javascript:;",role:"button",onmousedown:"return false;",title:r,"class":"mcePath_"+w++},a),d.hasChildNodes()?(d.insertBefore(i.create("span",{"aria-hidden":"true"}," » "),d.firstChild),d.insertBefore(o,d.firstChild)):d.appendChild(o)}},t.getBody()),i.select("a",d).length>0&&(b.statusKeyboardNavigation=new e.ui.KeyboardNavigation({root:t.id+"_path_row",items:i.select("a",d),excludeFromTabOrder:!0,onCancel:function(){t.focus()}},i)))},_sel:function(e){this.editor.execCommand("mceSelectNodeDepth",!1,e)},_mceInsertAnchor:function(){var t=this.editor;t.windowManager.open({url:this.url+"/anchor.htm",width:320+e.parseInt(t.getLang("advanced.anchor_delta_width",0)),height:90+e.parseInt(t.getLang("advanced.anchor_delta_height",0)),inline:!0},{theme_url:this.url})},_mceCharMap:function(){var t=this.editor;t.windowManager.open({url:this.url+"/charmap.htm",width:550+e.parseInt(t.getLang("advanced.charmap_delta_width",0)),height:265+e.parseInt(t.getLang("advanced.charmap_delta_height",0)),inline:!0},{theme_url:this.url})},_mceHelp:function(){var e=this.editor;e.windowManager.open({url:this.url+"/about.htm",width:480,height:380,inline:!0},{theme_url:this.url})},_mceShortcuts:function(){var e=this.editor;e.windowManager.open({url:this.url+"/shortcuts.htm",width:480,height:380,inline:!0},{theme_url:this.url})},_mceColorPicker:function(t,n){var i=this.editor;n=n||{},i.windowManager.open({url:this.url+"/color_picker.htm",width:375+e.parseInt(i.getLang("advanced.colorpicker_delta_width",0)),height:250+e.parseInt(i.getLang("advanced.colorpicker_delta_height",0)),close_previous:!1,inline:!0},{input_color:n.color,func:n.func,theme_url:this.url})},_mceCodeEditor:function(){var t=this.editor;t.windowManager.open({url:this.url+"/source_editor.htm",width:e.parseInt(t.getParam("theme_advanced_source_editor_width",720)),height:e.parseInt(t.getParam("theme_advanced_source_editor_height",580)),inline:!0,resizable:!0,maximizable:!0},{theme_url:this.url})},_mceImage:function(){var t=this.editor;-1==t.dom.getAttrib(t.selection.getNode(),"class","").indexOf("mceItem")&&t.windowManager.open({url:this.url+"/image.htm",width:355+e.parseInt(t.getLang("advanced.image_delta_width",0)),height:275+e.parseInt(t.getLang("advanced.image_delta_height",0)),inline:!0},{theme_url:this.url})},_mceLink:function(){var t=this.editor;t.windowManager.open({url:this.url+"/link.htm",width:310+e.parseInt(t.getLang("advanced.link_delta_width",0)),height:200+e.parseInt(t.getLang("advanced.link_delta_height",0)),inline:!0},{theme_url:this.url})},_mceNewDocument:function(){var e=this.editor;e.windowManager.confirm("advanced.newdocument",function(t){t&&e.execCommand("mceSetContent",!1,"")})},_mceForeColor:function(){var e=this;this._mceColorPicker(0,{color:e.fgColor,func:function(t){e.fgColor=t,e.editor.execCommand("ForeColor",!1,t)}})},_mceBackColor:function(){var e=this;this._mceColorPicker(0,{color:e.bgColor,func:function(t){e.bgColor=t,e.editor.execCommand("HiliteColor",!1,t)}})},_ufirst:function(e){return e.substring(0,1).toUpperCase()+e.substring(1)}}),e.ThemeManager.add("advanced",e.themes.AdvancedTheme)})(tinymce);