//>>built
define("epi-cms/contentediting/ContentReferencesNotification",["dojo/_base/array","dojo/_base/declare","dojo/_base/event","dojo/dom-construct","dojo/Stateful","dojo/on","dojo/when","epi/epi","epi/dependency","epi/shell/TypeDescriptorManager","epi/shell/DestroyableByKey","epi-cms/command/BackCommand","epi-cms/widget/sharedContentDialogHandler","epi/i18n!epi/cms/nls/episerver.cms.contentediting.notificationbar"],function(_1,_2,_3,_4,_5,on,_6,_7,_8,_9,_a,_b,_c,_d){return _2([_5,_a],{_backCommand:null,_clickHandleKey:"clickHandle",constructor:function(){this._backCommand=new _b();},postscript:function(){this.inherited(arguments);this._store=this._store||_8.resolve("epi.storeregistry").get("epi.cms.contentreferences");},_valueSetter:function(_e){this.value=_e;var _f=_9.getValue(_e.contentData.typeIdentifier,"actAsAnAsset");if(!_f){this.set("notification",null);return;}_6(this._store.get(_e.contentData.contentLink)).then(this._updateNotification.bind(this));},_updateNotification:function(_10){if(!_10){this.set("notification",null);return;}var _11=_4.create("div");if(_10.length>0){_11.innerHTML+=_d.affect;var _12=_10.length+" "+(_10.length===1?_7.resources.text.item:_7.resources.text.items),_13=this,_14=_4.create("a",{href:"#",innerHTML:_12,title:_d.referencestooltip},_11);this.destroyByKey(this._clickHandleKey);this.ownByKey(this._clickHandleKey,on(_14,"click",function(evt){_3.stop(evt);_13._showReferenceDialog();}));}else{_11.innerHTML+=_7.resources.messages.notinuse;}this._backCommand.set("model",{});this.set("notification",{content:_11,commands:[this._backCommand]});},_showReferenceDialog:function(){_c({contentData:this.get("value").contentData,showToolbar:true,mode:_c.mode.show});}});});