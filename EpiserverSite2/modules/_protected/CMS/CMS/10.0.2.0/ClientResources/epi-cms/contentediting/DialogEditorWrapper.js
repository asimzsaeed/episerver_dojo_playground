//>>built
define("epi-cms/contentediting/DialogEditorWrapper",["epi","dojo","epi-cms/contentediting/_EditorWrapperBase","epi/shell/widget/dialog/Dialog"],function(_1,_2,_3,_4){return _2.declare([_3],{closeOnChange:true,showButtons:false,_dialog:null,buildRendering:function(){this.inherited(arguments);if(!this.editorWidget){_2["require"](this.editorWidgetType);var _5=_2.getObject(this.editorWidgetType);var _6=this.editorParams||{};if("displayedValue" in _5.prototype||"value" in _5.prototype){_6["displayedValue" in _5.prototype?"displayedValue":"value"]=this.value;}this.editorWidget=new _5(_6);}var ew=this.editorWidget;var _7=new _4({content:ew,title:this.propertyDisplayName,defaultActionsVisible:this.showButtons,contentClass:"epi-dialog-fullWidth",destroyOnHide:false});this.connect(ew,"onKeyPress",this._onKeyPress);this.connect(ew,"onCancel",this._onCancel);this.connect(ew,"onResize",_2.hitch(this,function(){this._dialog.resize();}));if("intermediateChanges" in ew){ew.set("intermediateChanges",true);}this.connect(ew,"onChange","_onChange");this.connect(_7,"onHide",this._onHide);this.connect(_7,"onCancel",this._onCancel);this._dialog=_7;},destroy:function(){this._dialog.destroyRecursive();this.inherited(arguments);},_onKeyPress:function(e){if(this.editing){if(e.altKey||e.ctrlKey){return;}if(e.keyCode===_2.keys.ESCAPE){_2.stopEvent(e);this.cancel();}else{if(e.keyCode===_2.keys.ENTER&&e.target.tagName==="INPUT"){_2.stopEvent(e);this._stopEdit();}}}},_onCancel:function(){this.cancel();this.editorWidget.set("value",this.value);if(this._dialog.open){this._dialog.hide();}},_onChange:function(){this.inherited(arguments);if(this.closeOnChange){this._stopEdit();}},_onHide:function(){if(this.editing){this._stopEdit();}},startEdit:function(){this.inherited(arguments);this._dialog.show();},_stopEdit:function(){this.inherited(arguments);if(this._dialog.open){this._dialog.hide();}},_setTitleAttr:function(_8){if(this._dialog){this._dialog.set("title",_8);}this._set("title",_8);}});});