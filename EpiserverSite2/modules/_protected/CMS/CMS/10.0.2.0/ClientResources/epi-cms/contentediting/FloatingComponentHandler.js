//>>built
define("epi-cms/contentediting/FloatingComponentHandler",["dojo/_base/declare","dojo/_base/lang","dojo/dom-construct","dojo/dom-style","dijit/Destroyable"],function(_1,_2,_3,_4,_5){return _1([_5],{setComponentPosition:function(_6,_7){if(!this._isValidComponentInfo(_6)||!this._isValidScrollInfo(_7)){return;}var _8=_7.viewportScrollInfo,_9=_7.overlayItemScrollInfo,_a=this._getComponentScrollConditions(_6,_7);this._floatComponentFromTop(_6,_6.componentSize.height);_a.floatFromLeft?this._floatComponentFromLeft(_6.component,0):this._floatComponentFromRight(_6.component,0);_a.floatHorizontalInside&&this._floatComponentHorizontalInside(_6,_7,_a);if(_a.floatVerticalInside){this._floatComponentVerticalInside(_6,_7,_a);return;}_a.floatFromBottom&&this._floatComponentFromBottom(_6,_6.componentSize.height);},destroy:function(){this._clearTogglePositionTimeout();this.inherited(arguments);},_isValidComponentInfo:function(_b){if(!_b){return false;}if(!_b.component){return false;}if(!_b.componentSize||!_b.componentSize.width||!_b.componentSize.height){return false;}if(!_b.relativeContainer){return false;}if(!_b.refContainer){return false;}return true;},_isValidScrollInfo:function(_c){if(!_c){return false;}if(!_c.viewportScrollInfo){return false;}if(!_c.overlayItemScrollInfo){return false;}return true;},_getComponentScrollConditions:function(_d,_e){var _f=_e.viewportScrollInfo,_10=_e.overlayItemScrollInfo,_11=_10.horizontal-_f.horizontal,_12=_f.bottom-_10.bottom,_13=_f.right-_10.vertical,_14=_10.left+_10.width,_15=this._hasHorizontalScroll(_f),_16=_f.scrollLeft<_10.left,_17=(_10.width+_10.left-_f.scrollLeft)>_d.componentSize.width,_18=_13>_d.componentSize.width||_13>=_14,_19=_11<_d.componentSize.height,_1a=_15&&(_d.componentSize.width<_10.width),_1b=(_d.componentSize.height>_11)&&(_d.componentSize.height>_12);return {horizontalScrolled:_15,keepPositionFromLeft:_16,insideContainerWidth:_17,floatFromLeft:_18,floatFromBottom:_19,floatHorizontalInside:_1a,floatVerticalInside:_1b};},_refreshComponentVerticalPosition:function(_1c,_1d){var _1e=_1d.viewportScrollInfo;this._floatComponentVertical(_1c,_1d.overlayItemScrollInfo.top);_1e.refreshPosition&&this._toggleRelativeContainerPosition(_1c,_1e.refreshDelayTime);},_floatComponentHorizontalInside:function(_1f,_20,_21){var _22=_20.viewportScrollInfo,_23=_20.overlayItemScrollInfo,_24=_21.keepPositionFromLeft,_25=_21.insideContainerWidth;if(_24){return;}if(_25){this._floatComponentFromLeft(_1f.component,_22.scrollLeft-_23.left,true);return;}this._floatComponentFromRight(_1f.component,0);},_floatComponentVerticalInside:function(_26,_27,_28){var _29=_27.viewportScrollInfo,_2a=_27.overlayItemScrollInfo,_2b=_28.floatFromLeft,_2c=_28.horizontalScrolled,_2d=_28.keepPositionFromLeft,_2e=_28.insideContainerWidth,_2f=_26.componentSize.width>_2a.width;if(!_2b){var _30=_28.horizontalScrolled?(_29.scrollLeft-_2a.width):_2a.width;this._floatComponentFromRight(_26.component,_30,_28.horizontalScrolled);this._refreshComponentVerticalPosition(_26,_27);return;}if(!_2c){this._refreshComponentVerticalPosition(_26,_27);return;}if(_2f){this._floatComponentFromLeft(_26.component,_29.scrollLeft);this._refreshComponentVerticalPosition(_26,_27);return;}var _31=_2d?_29.scrollLeft:(_2e?_2a.left:(_26.componentSize.width+_29.scrollLeft-_2a.width));this._floatComponentFromLeft(_26.component,_31);this._refreshComponentVerticalPosition(_26,_27);},_floatComponentVertical:function(_32,_33){_4.set(_32.component,{top:this._getPositionString(_33)});_4.set(_32.relativeContainer,{position:"fixed"});},_floatComponentFromTop:function(_34,_35,_36){this._changeComponentContainerPlace(_34,"first");_4.set(_34.component,{bottom:"auto",left:"auto",right:"auto",top:this._getPositionString(_35,_36)});},_floatComponentFromLeft:function(_37,_38,_39){_4.set(_37,{left:this._getPositionString(_38,_39),right:"auto"});},_floatComponentFromBottom:function(_3a,_3b,_3c){this._changeComponentContainerPlace(_3a,"last");_4.set(_3a.component,{bottom:this._getPositionString(_3b,_3c),top:"auto"});},_floatComponentFromRight:function(_3d,_3e,_3f){_4.set(_3d,{left:"auto",right:this._getPositionString(_3e,_3f)});},_changeComponentContainerPlace:function(_40,_41){_3.place(_40.relativeContainer,_40.refContainer,_41);_4.set(_40.relativeContainer,{position:"relative"});},_toggleRelativeContainerPosition:function(_42,_43){this._clearTogglePositionTimeout();var _44=_42.component,_45=_42.relativeContainer,_46=_4.get(_42.relativeContainer,"position"),_47=function(){_4.set(_45,{position:_46});_4.set(_44,{display:"block"});};_4.set(_45,{position:"relative"});_4.set(_44,{display:"none"});_43!=null?(this._togglePositionTimeout=setTimeout(_47,_43)):_47();},_clearTogglePositionTimeout:function(){if(this._togglePositionTimeout){clearTimeout(this._togglePositionTimeout);this._togglePositionTimeout=null;}},_hasHorizontalScroll:function(_48){return _48&&_48.scrollLeft!=null&&_48.scrollLeft>0;},_getPositionString:function(_49,_4a){return _49===0?0:((_4a===true?"":"-")+_49+"px");}});});