//>>built
define("epi-cms/contentediting/InlineEditorWrapper",["dojo/_base/array","dojo/_base/declare","dojo/_base/event","dojo/_base/lang","dojo/dom-style","dojo/Deferred","dojo/on","dojo/when","epi-cms/contentediting/OverlayBasedEditorWrapper"],function(_1,_2,_3,_4,_5,_6,on,_7,_8){return _2([_8],{width:"100%",hasInlineEditor:true,matchStyle:false,destroy:function(){this._removeLocalHandlers();this._blockDisplayNodeOpacity=null;this.inherited(arguments);},tryToStopEditing:function(){var _9=this.getEditorWidget();if(_9&&_9.isEditing()){_9.onEditorBlur();}this.inherited(arguments,[true]);},_getOrCreateEditor:function(){if(this._createdEditor){return this.editorWidget;}var _a=new _6();var _b=_4.mixin(this.editorParams,{value:this.value});if(this.matchStyle){_b.style=this._computeStyling();}require([this.editorWidgetType],_4.hitch(this,function(_c){var _d=this.editorWidget=new _c(_b);_d.placeAt(this.get("overlayItem").domNode);this.own(on(_d.domNode,"editorstatechanged",_4.hitch(this,this._onEditorStateChanged)));this._handlers=[this.connect(_d,"onClick",_3.stop),this.connect(_d,"onEditorResizing",this._onEditorResizing),this.connect(_d,"onEditorResized",this._onEditorResized)];this._handlers.push(this.connect(_d,"onChange","_onEditorChange"));this._handlers.push(this.connect(_d,"onKeyPress","_onEditorKeyPress"));this._createdEditor=true;_a.resolve(_d);}));return _a;},_computeStyling:function(){var _e=_5.getComputedStyle(this.blockDisplayNode),_f="line-height:"+_e.lineHeight+";",_10=_5.getComputedStyle(this.domNode);["Weight","Family","Size","Style"].forEach(function(_11){var _12=_e["font"+_11],_13=_10["font"+_11];if(_13!==_12){_f+="font-"+_11+":"+_e["font"+_11]+";";}},this);var _14=this.width;if(_14==="100%"){_f+="width:100%;";}else{_f+="width:"+(_14+(Number(_14)===_14?"px":""))+";";}_f+="position: absolute; left: 0px; top: 0px;";return _f;},_onEditorChange:function(_15){this._onChange(_15);},_onEditorResizing:function(_16){},_onEditorResized:function(_17){},_onEditorStateChanged:function(_18){var _19=this.get("overlayItem");_19&&_19.set("error",_18==="Error");},startEdit:function(){var _1a=this.getInherited(arguments);_7(this._getOrCreateEditor(),_4.hitch(this,function(_1b){this._blockDisplayNodeOpacity=_5.get(this.blockDisplayNode,"opacity");_5.set(_1b.domNode,{display:""});_5.set(this.blockDisplayNode,{opacity:0.5});_1a.apply(this);this.focus();}));},_removeLocalHandlers:function(){(this._handlers instanceof Array&&this._handlers.length>0)&&this._handlers.forEach(function(_1c){_1c.remove();});},_onTryToStopWithInvalidValue:function(){},_removeEditingFeatures:function(){(this.blockDisplayNode&&this._blockDisplayNodeOpacity)&&_5.set(this.blockDisplayNode,{opacity:this._blockDisplayNodeOpacity});(this.editorWidget&&this.editorWidget.domNode)&&_5.set(this.editorWidget.domNode,"display","none");},_toggleSupportCustomDnd:function(_1d){var _1e=this.get("overlayItem");if(!_1e){return;}var _1f=this.getEditorWidget();if(!_1f||!_1f.supportCustomDnd){return;}if(_1d===true){_1e.transferDndControlTo(_1f);}else{_1e.transferDndControlTo(_1e);}},_toggleOverlayItemZIndex:function(_20){var _21=this.get("overlayItem");if(!_21||!_21.item){return;}var _22=parseInt(_5.get(_21.item,"zIndex"),10);_5.set(_21.item,{zIndex:_20===true?++_22:--_22});}});});