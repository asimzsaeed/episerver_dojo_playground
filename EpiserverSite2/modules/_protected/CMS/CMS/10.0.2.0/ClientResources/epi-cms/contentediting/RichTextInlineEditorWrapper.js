//>>built
define("epi-cms/contentediting/RichTextInlineEditorWrapper",["dojo/_base/declare","dojo/_base/lang","dojo/dom-style","dojo/on","epi-cms/contentediting/_FloatingComponentEditorWrapperMixin","epi-cms/contentediting/InlineEditorWrapper"],function(_1,_2,_3,on,_4,_5){return _1([_5,_4],{isUndoDisabled:true,postCreate:function(){this.inherited(arguments);this.own(on(this.get("iframeWithOverlay").iframe,"unload",_2.hitch(this,function(){this.tryToStopEditing();this._blockDisplayNodeOpacity=this.blockDisplayNode=this.overlayItem=null;})));},setupFloatingComponentEditorWrapper:function(_6){this.inherited(arguments);this._setupFloatingEvents(_6);},focus:function(){this.inherited(arguments);this.blockDisplayNode&&_3.set(this.blockDisplayNode,{visibility:"hidden"});this._toggleOverlayItemZIndex(true);this._toggleSupportCustomDnd(true);},startEdit:function(){_2.mixin(this.editorParams,{ready:this.get("overlayItem")!=null});this.inherited(arguments);this.setupFloatingComponentEditorWrapper(this._getComponentFloaterInfo());},tryToStopEditing:function(){this.inherited(arguments);var _7=this.getEditorWidget();if(_7&&_7.tryToStopEditing){_7.tryToStopEditing();}},_onEditorResizing:function(_8){this.blockDisplayNode&&_3.set(this.blockDisplayNode,_8.style);},_onEditorResized:function(_9){var _a=this.get("overlayItem");_a&&_a.onResize();_9&&(this._deferEditorResizedCallback=this.defer(_9,100));},_removeEditingFeatures:function(){this.inherited(arguments);this.blockDisplayNode&&_3.set(this.blockDisplayNode,{height:"auto",visibility:"visible"});this._toggleOverlayItemZIndex();this._toggleSupportCustomDnd();},_setupFloatingEvents:function(_b){var _c=this.get("iframeWithOverlay"),_d=_2.hitch(this,function(_e){var _f=this.getEditorWidget();if(!_f||!_f.isEditing()){return;}_2.mixin(_b,{floatingInfo:{delayTime:_e!=null&&_e.type==="viewportresized"?100:null,refreshPosition:_e!=null&&(_e.type==="viewportresized"||_e.type==="viewportpulldown"),refreshDelayTime:_e!=null&&_e.type==="viewportpulldown"?0:100}});this.onComponentFloat(_b);});this.own(on(_c.previewContainer,"scroll",_d),on(_c.scroller,"scroll",_d),on(_c.domNode,"viewportresized, viewportpulldown",_d));},_getComponentFloaterInfo:function(){var _10=this.get("iframeWithOverlay"),_11=this.get("overlayItem");return {componentInfo:{component:this.getEditorWidget(),componentOverlayItem:_11?_11.item:null,viewport:_10.previewContainer,viewportIframe:_10.iframe.domNode,viewportScroller:_10.scroller}};}});});