//>>built
define("epi-cms/contentediting/_ContextualContentContextMixin",["dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/when","epi-cms/_ContentContextMixin","epi/shell/TypeDescriptorManager","epi-cms/ApplicationSettings","epi-cms/contentediting/PseudoContextualCommandDecorator","epi-cms/core/ContentReference"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9){return _2([_5],{_commandDecorator:null,postscript:function(){this.inherited(arguments);this._commandDecorator=this._commandDecorator||new _8();},destroy:function(){this._commandDecorator&&this._commandDecorator.destroy();this.inherited(arguments);},isTypeOfRoot:function(_a){var _b=this.inherited(arguments),_c=this.isContextualContent(_a);return _b!=null?!!(_b||_c):!!(_a&&_c);},isContextualContent:function(_d){return this.isContextualRoot(_d)||this.isPseudoContextualRoot(_d);},isContextualRoot:function(_e){return _e.parentLink==this._getPseudoContextualContent();},isPseudoContextualRoot:function(_f){var _10=_9.toContentReference(_f.contentLink);return !_10.providerName&&_10.id==this._getPseudoContextualContent();},hasContextual:function(_11){if(!(_11 instanceof Array)||_11.length<=0){return false;}return _1.some(_11,this.isContextualContent,this);},canHaveContextualContent:function(_12){var _13=_9.toContentReference(_12.contentLink);return !_1.some(this.notSupportContextualContents,function(id){return !_13.providerName&&_13.id==id;});},getContextualRoot:function(_14){if(typeof _14!=="object"){return null;}var _15=_3.clone(_14);_15.name=this.getContextualRootName(_15);if(this.isPseudoContextualRoot(_15)){_15.hasChildren=false;}return _15;},getContextualRootName:function(_16){var _17=_16&&_16.ownerTypeIdentifier,_18=_17||(this._currentContext&&this._currentContext.dataType)||"",_19=_6.getResourceValue(_18,"name",true);var _1a=_6.getResourceValue(_18,"forthis",false);return _19?_3.replace(_1a,[_19]):_1a;},decoratePseudoContextualCommands:function(_1b){_4(this.getCurrentContent()).then(_3.hitch(this,function(_1c){this._commandDecorator.decorateCommands(_1b,_1c,_3.hitch(this,this.isPseudoContextualRoot));})).otherwise(function(){});},_getPseudoContextualContent:function(){return _7.contentAssetsFolder;}});});