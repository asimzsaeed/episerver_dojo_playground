//>>built
define("epi-cms/contentediting/command/ManageExpiration",["dojo/_base/connect","dojo/_base/declare","dojo/_base/Deferred","dojo/_base/lang","epi","epi/datetime","epi-cms/contentediting/ExpirationDialog","epi-cms/contentediting/viewmodel/ExpirationDialogViewModel","epi-cms/contentediting/ContentActionSupport","epi/shell/command/_Command","epi/shell/widget/dialog/Dialog","epi/i18n!epi/cms/nls/episerver.cms.widget.expirationeditor","epi/i18n!epi/nls/episerver.shared"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d){return _2([_a],{label:_c.dialogtitle,tooltip:_c.dialogtitle,viewModel:null,cssClass:"epi-chromelessButton epi-visibleLink",_execute:function(){var _e=this.createDialog();_e.on("execute",_4.hitch(this,this._onExecute));_e.show();},createDialog:function(){var _f=this.get("viewModel");var _10=new _7({model:_f});return new _b({defaultActionsVisible:false,confirmActionText:_d.action.save,content:_10,title:_c.dialogtitle});},_onModelChange:function(){var _11=this.get("model");if(!_11||!_11.contentData){this.set("canExecute",false);return;}var _12=_11.contentData.properties,_13=_12.iversionable_expire;var _14=_11.canChangeContent()&&_9.hasAccess(_11.contentData.accessMask,_9.accessLevel.Publish);this.set("canExecute",false);_3.when(_11.getPropertyMetaData("iversionable_expire"),_4.hitch(this,function(_15){this.set("viewModel",new _8({metadata:_15,contentLink:_11.contentLink,contentName:_11.contentData.name,value:_13,minimumExpireDate:_12.iversionable_startpublish}));this.set("canExecute",_14);}));},_onExecute:function(_16){var _17=this.get("model");_17.saveAndPublishProperty("iversionable_expire",_16);}});});