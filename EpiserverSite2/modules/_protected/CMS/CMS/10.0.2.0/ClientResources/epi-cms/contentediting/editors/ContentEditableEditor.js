//>>built
define("epi-cms/contentediting/editors/ContentEditableEditor",["dojo/_base/declare","dojo/_base/lang","dojo/dom-attr","dojo/dom-class","dojo/dom-style","dojo/on","dojo/query","dijit/_FocusMixin","dijit/_WidgetBase","dijit/focus","dijit/Tooltip","epi/string","epi/shell/widget/_ValueRequiredMixin","epi-cms/contentediting/editors/_ClipboardPasteMixin"],function(_1,_2,_3,_4,_5,on,_6,_7,_8,_9,_a,_b,_c,_d){return _1([_8,_7,_c,_d],{baseClass:"epi-content-editable-editor",uiSafeHtmlTags:[],blockDisplayNode:null,postCreate:function(){this.inherited(arguments);var _e=this.blockDisplayNode;this.pasteMixinSetup(this.id,_e);this.own(on(this.domNode,"click",_2.hitch(this,function(e){this.get("state")==="Error"&&this._makeContentEditable();})),on(_e,"blur",_2.hitch(this,this.validate)),on(_e,"keydown",_2.hitch(this,this.validate)));},destroy:function(){this.blockDisplayNode=null;var _f=this.tooltipNode||this.domNode;if(_f){_a.hide(_f);}this.inherited(arguments);},focus:function(){this._makeContentEditable();this.inherited(arguments);},isValid:function(_10){var _11=this.get("value");if(this.required&&_b.isNullOrEmpty(_11)){return false;}if(this.pattern&&!(new RegExp(this.pattern).test(_11))){return false;}return true;},getErrorMessage:function(_12){return (this.required&&_b.isNullOrEmpty(this.get("value")))?this.missingMessage:this.invalidMessage;},validate:function(_13){this.focused=_13;var _14=this.inherited(arguments);this.set("message",this.getErrorMessage());return _14;},_makeContentEditable:function(){var _15=this.blockDisplayNode;_3.set(_15,"contenteditable","true");_5.set(this.domNode,"width","auto");_9.focus(_15);this.get("state")!=="Error"&&this._setCaretPosition(_15,_15.textContent.length);},_setCaretPosition:function(_16,_17){var _18=_16.ownerDocument,_19=_18.createRange(),_1a=_18.getSelection();if(!_16.lastChild){_16.appendChild(_18.createTextNode(""));}_17=Math.min(_16.lastChild.textContent.length,_17);_19.setStart(_16.lastChild,_17);_19.collapse(true);_1a.removeAllRanges();_1a.addRange(_19);},_getValueAttr:function(){return _2.trim(_6(this.blockDisplayNode).text());},_setValueAttr:function(val){_6(this.blockDisplayNode).text(val||"");},_removeEditingFeatures:function(){_3.remove(this.blockDisplayNode,"contenteditable");}});});