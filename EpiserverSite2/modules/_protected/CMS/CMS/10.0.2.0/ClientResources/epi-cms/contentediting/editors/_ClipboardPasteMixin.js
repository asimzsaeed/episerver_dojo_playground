//>>built
define("epi-cms/contentediting/editors/_ClipboardPasteMixin",["dojo/_base/array","dojo/_base/declare","dojo/_base/event","dojo/_base/lang","dojo/_base/window","dojo/dom-attr","dojo/dom-class","dojo/dom-construct","dojo/on","dojo/query","dojo/_base/kernel","dijit/Destroyable","epi/string"],function(_1,_2,_3,_4,_5,_6,_7,_8,on,_9,_a,_b,_c){return _2(_b,{_editingKey:"",_editingNode:null,_editingContainer:null,_beginEditingPoint:null,_endEditingPoint:null,_pasteEventActive:false,_beginEditingPointCSSClass:"epi-content-editable-begin-edit",_endEditingPointCSSClass:"epi-content-editable-end-edit",canAccessClipboard:function(_d){return !!this.getClipboard(_d);},getClipboard:function(_e){return (_e&&_e.clipboardData)||_5.global.clipboardData;},getClipboardData:function(_f){var _10=this.getClipboard(_f);return (_10&&_5.global.clipboardData)?_10.getData("Text"):_10.getData("text/plain");},destroy:function(){this.inherited(arguments);this._destroyRedundantNodes([this._beginEditingPoint||this._getEditingPoint("before"),this._endEditingPoint||this._getEditingPoint("after")]);this._editingNode=this._editingContainer=this._beginEditingPoint=this._endEditingPoint=null;},pasteMixinSetup:function(_11,_12){if(!_12){return;}this._editingKey=_11;this._editingNode=_12;this._editingContainer=this._editingNode.parentNode;this.own(on(this._editingNode,"beforepaste",_4.hitch(this,this._onBeforePaste)),on(this._editingNode,"paste",_4.hitch(this,this._onPaste)),on(this._editingNode,"input",_4.hitch(this,this._onInput)));},_onBeforePaste:function(evt){if(this.canAccessClipboard(evt)&&_5.global.clipboardData){this.getClipboard(evt).setData("Text",_c.stripHtmlTags(this.getClipboardData(evt)));}},_onPaste:function(evt){if(_5.global.clipboardData){return;}if(this.canAccessClipboard(evt)){this._processNativePaste(evt);_3.stop(evt);return;}},_onInput:function(evt){if(this.canAccessClipboard(evt)||!this._pasteEventActive){return;}this._processManualPaste();},_processNativePaste:function(evt){var _13=this._editingNode.ownerDocument,_14=_c.stripHtmlTags(this.getClipboardData(evt));if(!_c.isNullOrEmpty(_14)){_13.execCommand("insertText",false,_14);}},_getEditingPoint:function(_15){return _9("span."+this._getEditingPointClass(_15),this._editingContainer)[0];},_getEditingPointClass:function(_16){var _17=(_16==="before"?this._beginEditingPointCSSClass:this._endEditingPointCSSClass);if(!_c.isNullOrEmpty(this._editingKey)){_17+="-"+this._editingKey;}return _17;},_createEditingPoint:function(_18){var _19=_8.create("span",{"class":this._getEditingPointClass(_18),style:"display:none;position:absolute;left:-99em;"},this._editingNode,_18==="before"?"before":"after");return _19;},_destroyRedundantNodes:function(_1a){if(_1a instanceof Array&&_1a.length>0){_1a.forEach(_8.destroy);}}});});