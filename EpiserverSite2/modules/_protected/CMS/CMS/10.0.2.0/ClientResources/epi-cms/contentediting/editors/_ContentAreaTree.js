//>>built
define("epi-cms/contentediting/editors/_ContentAreaTree",["dojo/_base/declare","dojo/aspect","dojo/_base/event","dojo/_base/array","dojo/_base/lang","dojo/dom-class","dijit/registry","epi/dependency","epi/shell/conversion/ObjectConverterRegistry","epi/shell/dnd/tree/dndSource","epi/shell/TypeDescriptorManager","epi/shell/widget/Tree","epi-cms/contentediting/viewmodel/ContentBlockViewModel","epi-cms/contentediting/viewmodel/PersonalizedGroupViewModel","./_BlockTreeNode","./_GroupTreeNode"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10){return _1([_c],{showRoot:false,dndController:_a,betweenThreshold:8,postMixInProperties:function(){this.inherited(arguments);this.accept.push("personalizationarea");},postCreate:function(){this.inherited(arguments);_6.add(this.domNode,"epi-tree-mngr");this.own(_2.after(this.dndController,"onDndItemRemoved",_5.hitch(this,function(_11){if(_11[0]&&_11[0].data){this.model.deleteItem(_11[0].data);}}),true));this.own(_2.after(this,"_onItemChildrenChange",_5.hitch(this,function(_12,_13){_4.forEach(_13,function(_14){var _15=this._itemNodesMap[this.model.getIdentity(_14)];if(_14.expandOnAdd){this._expandNode(_15[0]);}if(_14.contentGroup&&_14.ensurePersonalization&&_14.hasAnyRoles&&!_14.hasAnyRoles()){_15[0].showPersonalizationSelector();}},this);}),true));},getTooltip:function(_16){return _16.label||"";},_setReadOnlyAttr:function(_17){this._set("readOnly",_17);if(this.dndController){this.dndController.isSource=!_17;}},getItemType:function(_18){if(!_18.typeIdentifier){if(_18.contentGroup!==undefined){return ["personalizationarea"];}else{return null;}}return this.accept;},checkItemAcceptance:function(_19,_1a,_1b,_1c){if(this.tree.readOnly){return false;}var _1d=_7.getEnclosingWidget(_19);var _1e=_1d.item;var _1f=true;_1a.forInSelectedItems(function(_20){_1f=this.tree.model.checkItemAcceptance(_1e,_20.data.item,_1b);},this);return _1f;},_onNodeMouseEnter:function(_21){_21.set("mouseHover",true);},_onNodeMouseLeave:function(_22){_22.set("mouseHover",false);},_createTreeNode:function(_23){var _24;if(_23.item instanceof _e){_24=new _10(_23);}else{if(_23.item instanceof _d){_24=new _f(_23);}else{_24=this.inherited(arguments);}}_24.set("contextMenu",this.contextMenu);_24.set("dndData",_23.item);return _24;},onClick:function(_25,_26,e){if(_26 instanceof _10){if(_26.isExpanded){this._collapseNode(_26);}else{this._expandNode(_26);}}}});});