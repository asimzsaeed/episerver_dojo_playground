//>>built
define("epi-cms/legacy/EditPropertyWidget",["epi","dojo","dijit","dojo/i18n","dojo/string","dojox/html/entities","epi-cms/contentediting/RenderManager","epi-cms/legacy/LegacyDialogWrapper","epi/routes"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9){return _2.declare([_8],{editorFeatures:null,value:"",contentLink:null,contentTypeId:null,contentLanguage:null,propertyName:null,fullName:null,_reloadOnNextEdit:false,onChange:function(_a){},postMixInProperties:function(){this.features=_2.mixin({width:400,height:30},this.editorFeatures);this.autoFit=true;this.connect(this,"onCallback","_onCallback");this.inherited(arguments);},startup:function(){this.inherited(arguments);var _b={moduleArea:"LegacyCMS",path:"edit/EditProperty.aspx",epslanguage:this.contentLanguage,propertyname:this.fullName};_2.mixin(_b,this.contentLink?{id:this.contentLink}:{contentTypeId:this.contentTypeId,parentLink:this.parentLink});this.set("url",_9.getActionPath(_b));},_setUrlAttr:function(_c){this._currentUrl=_c;var _d=_6.encode(_2.toJson(this.value));var _e=_5.substitute("<html><body><form method=\"post\" action=\"${0}\" ><input type=\"hidden\" name=\"value\" value=\"${1}\" /></form></body></html>",[_c,_d]);this.containerIframe.contentDocument.write(_e);this.containerIframe.contentDocument.forms[0].submit();},_onCallback:function(_f){var _10=_f.value;var _11=_2.fromJson(_10);if(this._oldStringValue===undefined){this._oldStringValue=_2.toJson(this.value);}if(_10!==this._oldStringValue){this._oldStringValue=_2.toJson(_11);this.value=_11;this.onChange(_11);}else{this.onCancel();}},resize:function(){this.inherited(arguments);if(this._reloadOnNextEdit){this._reloadOnNextEdit=false;this._reloadUrl(true);}},_setValueAttr:function(_12){this._set("value",_12);if(this._started){this._reloadOnNextEdit=true;}}});});