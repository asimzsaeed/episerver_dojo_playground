//>>built
define("epi-cms/legacy/LegacyFormEditor",["dojo/_base/declare","dojo/_base/lang","dijit/focus","dijit/_Widget","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","dijit/form/Button","epi","epi/dependency","epi/shell/widget/dialog/Dialog","epi-cms/widget/_HasChildDialogMixin","epi/shell/widget/_ValueRequiredMixin","epi-cms/legacy/EditPropertyWidget","epi/i18n!epi/cms/nls/episerver.cms.legacy.legacyformeditor"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e){return _1([_4,_5,_6,_b,_c],{localization:_e,destroyOnHide:false,editorWidgetClass:_d,templateString:"            <div class=\"dijit dijitReset dijitInline dijitLeft epi-legacyFormEditor\">                <div data-dojo-type=\"dijit/form/Button\" data-dojo-attach-point=\"openButton\" data-dojo-attach-event=\"onClick: openEditor\" data-dojo-props=\"label:'${localization.helptext}'\"></div>            </div>",editorWidget:null,value:null,multiple:false,contentLink:null,contentTypeId:null,contentLanguage:null,propertyName:null,_dialog:null,onChange:function(){},postCreate:function(){this.inherited(arguments);_2.mixin(this.params,{contentLink:this.contentLink});},buildRendering:function(){this.inherited(arguments);if(this.output){this.output.set("disabled",true);}},destroy:function(){if(this._dialog){this._dialog.destroyRecursive();}this.inherited(arguments);},_setReadOnlyAttr:function(_f){this._set("readOnly",_f);this.openButton.set("disabled",_f);},_setValueAttr:function(_10){this._set("value",_10);if(this.editorWidget&&!_8.areEqual(_10,this.editorWidget.get("value"))){this.editorWidget.set("value",_10);}this.setDisplayValue(_10);},_onChange:function(){var _11=this.editorWidget.get("value");this.set("value",_11);this.onChange(_11);if(this._dialog&&this._dialog.open){this._dialog.hide();}},_onCancel:function(){this._dialog.hide();},_onDialogHide:function(){this.isShowingChildDialog=false;if(this.destroyOnHide){this.editorWidget=this._dialog=null;}},openEditor:function(){this.isShowingChildDialog=true;if(!this._dialog){this._createDialog();}this.editorWidget.set("value",this.value);this._dialog.show();},_createDialog:function(){var _12=this.editorWidgetClass;this.editorWidget=new _12(this.params);this._dialog=new _a({destroyOnHide:this.destroyOnHide,content:this.editorWidget,title:this.editorWidget.title||this.label,defaultActionsVisible:false,dialogClass:"",contentClass:"epi-dialog-fullWidth"});this.connect(this.editorWidget,"onResize",_2.hitch(this,function(){this._dialog.resize();}));this.connect(this.editorWidget,"onChange","_onChange");this.connect(this.editorWidget,"onCancel","_onCancel");this.connect(this._dialog,"onHide","_onDialogHide");},setDisplayValue:function(_13){if(this.output){this.output.set("value",this.localization.helptext);}},focus:function(){this.openButton.focus();}});});