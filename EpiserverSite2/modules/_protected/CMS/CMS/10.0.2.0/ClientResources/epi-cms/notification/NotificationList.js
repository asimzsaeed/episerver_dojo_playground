//>>built
require({cache:{"url:epi-cms/notification/templates/NotificationList.html":"<div class=\"epi-notification-list epi-menu--inverted\">\n    <div class=\"epi-menuInverted epi-invertedTooltip\">\n        <div class=\"epi-tooltipDialogTop\">\n            <span data-dojo-attach-point=\"headerNode\">${res.header}</span>\n            <div class=\"dijitTooltipConnector\"></div>\n        </div>\n        <div data-dojo-type=\"dijit/Toolbar\"\n             data-dojo-attach-point=\"toolbar\"\n             class=\"epi-flatToolbar\">\n            <div data-dojo-attach-point=\"toolbarGroupNode\" class=\"epi-floatRight\"></div>\n        </div>\n        <div data-dojo-attach-point=\"listNode\"></div>\n    </div>\n</div>\n"}});define("epi-cms/notification/NotificationList",["dojo/_base/connect","dojo/_base/declare","dojo/keys","dojo/on","./viewmodels/NotificationListViewModel","./notificationFormatter","dojo/text!./templates/NotificationList.html","epi/i18n!epi/cms/nls/episerver.cms.notification.list","dgrid/OnDemandList","dgrid/Keyboard","dgrid/Selection","epi/shell/dgrid/Focusable","epi/shell/dgrid/Formatter","epi-cms/dgrid/WithContextMenu","epi-cms/ApplicationSettings","epi/shell/command/builder/ButtonBuilder","epi/shell/command/builder/MenuAssembler","dijit/_WidgetBase","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","dijit/Toolbar"],function(_1,_2,_3,on,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11,_12,_13){return _2([_11,_12,_13],{templateString:_6,_listClass:_2([_8,_c,_a,_9,_d,_b]),_list:null,res:_7,postMixInProperties:function(){this.inherited(arguments);_5.contentLanguage=_e.currentContentLanguage;if(!this.model){this.own(this.model=new _4());}},buildRendering:function(){this.inherited(arguments);this._setupToolbar();this._setupList();},startup:function(){if(this._started){return;}this.inherited(arguments);this.model.initialize().then(function(){this._list.startup();this._list.set("store",this.model.store,this.model.query,this.model.queryOptions);this.own(on(this.model,"notification-allread",this._list.refresh.bind(this._list)),on(this.domNode,_1._keypress,this._onKeypress.bind(this)));this.emit("loaded");}.bind(this));},focus:function(){var _14;if(this._list){_14=this._list.getScrollPosition();this._list.focus();this._list.scrollTo(_14);}},layout:function(){this.inherited(arguments);this._list.resize();},_setupList:function(){var _15=this._readNotification.bind(this);this._list=new this._listClass({className:"epi-notification-list__item-list epi-card-list epi-grid-max-height--300",cleanEmptyObservers:false,commandCategory:"itemContext",deselectOnRefresh:false,formatters:_5.card,keepScrollPosition:true,noDataMessage:_7.nodatamessage,stopPropagation:true,sort:this.model.queryOptions&&this.model.queryOptions.sort},this.listNode);this._list.contextMenu.addProvider(this.model);this.own(this._list,this._list.on("dgrid-select",this._selected.bind(this)),this._list.on(".dgrid-row:click",_15),this._list.addKeyHandler(_3.ENTER,_15),on.once(this._list,"dgrid-refresh-complete",this.focus.bind(this)));},_readNotification:function(){this.model.readSelectedNotification();this.emit("change",{});},_selected:function(e){var _16=e&&e.rows&&e.rows[0].data;this.model.set("selectedNotification",_16);},_setupToolbar:function(){var _17=new _f({settings:{"class":"epi-chromeless epi-visibleLink"}});var _18=[{builder:_17,category:"toolbarContext",target:this.toolbarGroupNode}];this.own(new _10({configuration:_18,commandSource:this.model}));},_onKeypress:function(e){if(e.charOrCode!==_3.TAB){return;}this.toolbar.focused?this._list.focus():this.toolbar.focus();e.preventDefault();e.stopPropagation();}});});