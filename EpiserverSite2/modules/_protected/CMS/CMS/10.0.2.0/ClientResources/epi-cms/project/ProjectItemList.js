//>>built
require({cache:{"url:epi-cms/project/templates/ProjectItemList.html":"<div class=\"epi-project-item-list\">\n    <div data-dojo-type=\"dijit/Toolbar\"\n         data-dojo-attach-point=\"toolbar\"\n         class=\"epi-project-item-list__toolbar epi-flatToolbar\">\n        <span data-dojo-attach-point=\"toolbarSection\"></span>\n    </div>\n    <div data-dojo-attach-point=\"listContainer\" class=\"epi-project-item-list__container\">\n        <div data-dojo-attach-point=\"notificationBarNode\" class=\"epi-notificationBar dijitHidden\">\n            <div class=\"epi-notificationBarItem\">\n                <div class=\"epi-notificationBarText\">\n                    <p data-dojo-attach-point=\"notificationTextNode\"></p>\n                </div>\n            </div>\n        </div>\n        <div data-dojo-attach-point=\"overlayNode\"\n             class=\"epi-project-item-list__dnd-area epi-visible-dnd-area epi-project-list-area__dnd-area--empty-list dijitHidden\">\n            <span class=\"epi-project-item-list__dnd-area-content\">${res.droptoadditems}</span>\n        </div>\n        <div data-dojo-attach-point=\"itemListNode\"\n             class=\"epi-card-list dgrid--centered-no-data-message\"></div\n        ><div data-dojo-attach-point=\"activitySection\"\n              class=\"epi-activity-section\"></div>\n    </div>\n</div>\n"}});define("epi-cms/project/ProjectItemList",["dojo/_base/declare","dojo/_base/lang","dojo/aspect","dojo/dom-geometry","dojo/dom-class","dojo/keys","dojo/on","dijit/_WidgetsInTemplateMixin","dijit/layout/_LayoutWidget","dijit/_CssStateMixin","dgrid/Keyboard","dgrid/OnDemandList","dgrid/Selection","dgrid/extensions/DijitRegistry","epi","epi/shell/dnd/Target","epi/shell/dgrid/Focusable","epi/shell/dgrid/Formatter","epi/shell/dgrid/Responsive","epi/shell/widget/_FocusableMixin","epi/shell/widget/_SectionedTemplatedMixin","epi-cms/extension/events","epi-cms/dgrid/listItemFormatters","epi-cms/dgrid/WithContextMenu","epi/i18n!epi/cms/nls/episerver.cms.components.project","dojo/text!./templates/ProjectItemList.html"],function(_1,_2,_3,_4,_5,_6,on,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11,_12,_13,_14,_15,_16,_17,res,_18){return _1([_8,_14,_7,_9,_13],{contentLanguage:null,commandProvider:null,dndEnabled:false,sections:["toolbarSection","listContainer","activitySection"],templateString:_18,listItemType:"card",res:res,_listClass:_1([_b,_11,_c,_a,_17,_d,_10,_12]),_list:null,_noDataMessageWrapper:"<span class=\"dgrid-no-data__content\">{0}</span>",buildRendering:function(){this.inherited(arguments);this._setupList();},focus:function(){if(this._list){this._list.focus();}},layout:function(){var _19,_1a;if(!this._contentBox){return;}_19=_4.getMarginBox(this.toolbar.domNode).h+_4.getMarginBox(this.notificationBarNode).h;_1a=_2.mixin({},this._contentBox,{h:this._contentBox.h-_19});_4.setMarginBox(this.listContainer,_1a);this._list.resize();},clearSelection:function(){this._list.clearSelection();this.emit("selection-changed",{items:[]});},refresh:function(){this._list.refresh({keepScrollPosition:true});},setSelection:function(_1b){this.selectItems(_1b);this.emit("selection-changed",{items:_1b});},selectItems:function(_1c){this._list.clearSelection();_1c.forEach(function(_1d){this._list.select(_1d);},this);},toggleActivities:function(_1e){_5.toggle(this.domNode,"epi-project-item-list--activities-visible",_1e);},updateQuery:function(_1f,_20){var _21=!_20&&this.res.noquery?this.res.noquery:this.res.nodata,_22=_2.replace(this._noDataMessageWrapper,[_21]);this._list.set("noDataMessage",_22);if(this._list.store!==_1f||!_e.areEqual(this._list.query,_20)){this._list.set("store",_1f,_20);}},_setupList:function(){var _23,_24;_16.contentLanguage=this.contentLanguage;_23=new this._listClass({formatters:_16[this.listItemType],cleanEmptyObservers:false,commandCategory:"itemContext",deselectOnRefresh:false,farOffRemoval:Infinity,refocusOnRefresh:true,responsiveMap:{"epi-card-list--narrow":570}},this.itemListNode);_23.contextMenu.addProvider(this.commandSource);this.own(this._list=_23,_23.on("dgrid-cellfocusin, .dgrid-content:click",_2.hitch(this,function(evt){if(evt.target===_23.contentNode){this.clearSelection();}var _25=this._getSelectedItems(_23);this.emit("selection-changed",{items:_25});})),_23.on("dgrid-select, dgrid-deselect",_2.hitch(this,function(evt){var _26=this._getSelectedItems(_23);this.emit("active-items-changed",{items:_26});})),_23.on(".dgrid-row:dblclick",_2.hitch(this,function(evt){var _27=this._list.row(evt).data;this.emit("itemaction",{item:_27});})),_23.addKeyHandler(_6.ENTER,_2.hitch(this,function(evt){var _28=this._list.row(evt).data;this.emit("itemaction",{item:_28});})),_23.on(on.selector(".dgrid-row",_15.keys.del),_2.hitch(this,function(evt){var _29=this._list.row(evt).data;this.emit("itemremove",{item:_29});})),_24=new _f(this.overlayNode,{createItemOnDrop:false,accept:["episerver.core.icontentdata.reference"]}),_3.after(_24,"onDropData",_2.hitch(this,this._onDropData),true));},_getSelectedItems:function(_2a){var _2b=[];Object.keys(_2a.selection).forEach(function(key){if(_2a.selection[key]){var _2c=_2a.row(key).data;_2b.push(_2c);}});return _2b;},_onDropData:function(_2d){var _2e=_2d.map(function(_2f){return _2f.data;});this.emit("itemsdropped",{items:_2e});},_setDndEnabledAttr:function(_30){this._set("dndEnabled",_30);_5.toggle(this.overlayNode,"dijitHidden",!_30);},_setNotificationMessageAttr:function(_31){this.notificationTextNode.textContent=_31;_5.toggle(this.notificationBarNode,"dijitHidden",!_31);this.layout();},_setSortOrderAttr:function(_32){if(this._list.get("sort")!==_32){this._list.set("sort",_32);}},_setContentLanguageAttr:function(_33){this._set("contentLanguage",_33);_16.contentLanguage=_33;}});});