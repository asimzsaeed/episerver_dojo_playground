//>>built
define("epi-cms/project/viewmodels/ProjectComponentViewModel",["dojo/_base/declare","dojo/_base/lang","dojo/Deferred","dojo/when","./_ProjectViewModel","epi/i18n!epi/nls/episerver.cms.components.project"],function(_1,_2,_3,_4,_5,_6){return _1([_5],{createProjectInfo:"",hasProject:false,_selectedProjectProfileKey:"epi.selected-project-id",initialize:function(){this._updateHasProject();return this.inherited(arguments);},removeProject:function(){var _7=this,_8=this.projectStore;if(!this.selectedProject){return new _3().resolve();}return _8.remove(this.selectedProject.id).then(function(){_7._selectNextProject();});},_loadSelectedProject:function(){var _9=this.projectStore;return _4(this.profile.get(this._selectedProjectProfileKey),function(_a){if(!_a){return null;}return _4(_9.get(_a)).then(function(_b){var _c=!!_b||undefined;return this._updateHasProject(_c).then(function(){return _b;});}.bind(this)).otherwise(function(ex){return null;});}.bind(this));},_updatePlaceholderState:function(){var _d=this.get("hasProject"),_e=!!this.get("selectedProject"),_f="";if(!_d){_f="noProjects";this.set("createProjectInfo",_6.placeholder.noprojectscreated);}else{if(_d&&!_e){_f="noSelectedProject";this.set("createProjectInfo",_6.placeholder.noprojectselected);}}this.set("placeholderState",_f);},_getProjects:function(_10,_11,_12){return this.projectStore.query(null,{start:_10,count:_11,sort:_12});},_updateHasProject:function(_13){return _4(_13===true?[_13]:this._getProjects(0,1)).then(function(_14){var _15=_14.length>0;this.set("hasProject",_15);return _15;}.bind(this));},_selectNextProject:function(){_4(this._getProjects(0,1,this.get("projectSortOrder")),_2.hitch(this,function(_16){var _17=_16.length>0?_16[0]:null;this.set("selectedProject",_17);this.set("hasProject",_16.length>0);}));},_hasProjectSetter:function(_18){this.hasProject=_18;this._updatePlaceholderState();},_selectedProjectSetter:function(_19){this.inherited(arguments);if(!this.hasProject&&_19){this.set("hasProject",true);}else{this._updatePlaceholderState();}this.profile.set(this._selectedProjectProfileKey,_19&&_19.id,{location:"server"});}});});