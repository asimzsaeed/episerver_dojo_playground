//>>built
require({cache:{"url:epi-cms/widget/templates/ContentReferences.html":"<div class=\"epi-contentReferences\">\r\n    <div data-dojo-attach-point=\"contentReferencesNotificationBar\" class=\"epi-notificationBar epi-notificationBarWithBorders epi-notificationBarItem\">\r\n        <div data-dojo-attach-point=\"contentReferencesNotificationNode\" class=\"epi-notificationBarText\" ></div>\r\n    </div>\r\n    <div class=\"epi-captionPanel\" data-dojo-attach-point=\"captionPanelNode\">\r\n        <strong data-dojo-attach-point=\"totalLinksNode\"></strong>\r\n        <div class=\"epi-floatRight\">\r\n            <button class=\"epi-chromelessButton\"\r\n                    data-dojo-type=\"dijit/form/Button\"\r\n                    data-dojo-attach-event=\"onClick:fetchData\"\r\n                    data-dojo-props=\"iconClass:'epi-iconReload'\">${res.buttons.refresh}</button>\r\n        </div>\r\n    </div>\r\n    <div data-dojo-attach-point=\"gridNode\"></div>\r\n</div>\r\n"}});define("epi-cms/widget/ContentReferences",["dojo/_base/declare","dojo/_base/lang","dojo/dom-class","dojo/dom-construct","dojo/dom-style","dojo/keys","dojo/when","epi-cms/dgrid/formatters","epi/shell/TypeDescriptorManager","epi/dependency","./_GridWidgetBase","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","dojo/Evented","dojo/text!./templates/ContentReferences.html","epi/i18n!epi/cms/nls/episerver.cms.widget.contentreferences","dijit/form/Button"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10){return _1([_b,_c,_d,_e],{res:_10,templateString:_f,storeKeyName:"epi.cms.contentreferences",contextChangeEvent:"dblclick",trackActiveItem:false,ignoreVersionWhenComparingLinks:false,_setTotalLinksAttr:{node:"totalLinksNode",type:"innerText"},_setNotificationAttr:{node:"contentReferencesNotificationNode",type:"innerText"},_setNotificationBarStyleAttr:function(_11){switch(_11){case 1:_3.add(this.contentReferencesNotificationBar,"epi-statusIndicator epi-statusIndicatorOk");break;case 2:_3.add(this.contentReferencesNotificationBar,"epi-statusIndicator epi-statusIndicatorWarning");break;}},_setNumberOfReferencesAttr:function(_12){var _13=this.model.contentData,_14=_12>0;var _15=_2.hitch(this,function(_16,_17){var _18=_9.getResourceValue(_13.typeIdentifier,_16);this.set("notification",_18);this.set("notificationBarStyle",_17);});if(_14){if(_13.hasChildren){_15("referenceswithsubcontentwarning",2);}else{_15("referenceswarning",2);}}else{if(_13.hasChildren){_15("noreferenceswithsubcontentwarning",null);}else{if(_13.publicUrl){_15("publicreferencesnote",null);}else{_15("noreferencesnote",1);}}}if(_14){var _19=_12===1?_10.totallink:_10.totallinks;var _1a=_2.replace(_19,[_12]);this.set("totalLinks",_1a);}this._set("numberOfReferences",_12);},_setShowToolbarAttr:function(_1b){_5.set(this.captionPanelNode,"display",_1b?"":"none");},buildRendering:function(){var _1c=this._getLinkTemplate();var _1d=_2.mixin({columns:{name:{renderCell:_2.hitch(this,"_renderContentItem")},language:{className:"epi-width10",renderCell:function(obj,_1e,_1f){_7(_a.resolve("epi.shell.Profile").getContentLanguage(),function(_20){if(_1e!==_20){_1f.textContent=_1e;}});}},treePath:{className:"epi-width50",get:function(_21){return _21.treePath.join("<span class=\"epi-breadCrumbsSeparator\">&gt;</span>");},ellipsisNoTooltip:true},view:{className:"epi-width10",label:" ",formatter:function(){return _1c;},sortable:false}},store:this.store,query:{id:this.model.contentData.contentLink},showHeader:false},this.defaultGridMixin);this.inherited(arguments);this.grid=new this._gridClass(_1d,this.gridNode);_3.toggle(this.contentReferencesNotificationBar,"dijitHidden",this.model.mode==="show");},startup:function(){this.inherited(arguments);this.grid.on(".dgrid-column-view a:click",_2.hitch(this,"_onChangeContext"));this.grid.on("dgrid-refresh-complete",_2.hitch(this,"_afterDataFetched"));},fetchData:function(){this.grid.refresh();},_afterDataFetched:function(e){_7(e.results.total,_2.hitch(this,function(_22){this.set("numberOfReferences",_22);this.set("showToolbar",_22>0);_5.set(this.grid.domNode,"visibility",(_22>0)?"visible":"hidden");}));},_onChangeContext:function(e){var row=this.grid.row(e),_23={uri:row.data.uri};this._requestNewContext(_23,{sender:this});this.emit("viewReference");},_getLinkTemplate:function(){var _24=_4.create("a",{"class":"epi-visibleLink",innerHTML:_10.view.label,title:_10.view.tooltip});return _24.outerHTML;}});});