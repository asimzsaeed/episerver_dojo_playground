//>>built
define("epi-cms/widget/ContentTypeService",["dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/when","dojo/promise/all","epi/dependency","epi/shell/TypeDescriptorManager"],function(_1,_2,_3,_4,_5,_6,_7){return _1(null,{contentTypeStore:null,_getavailabletypesQuery:"getavailablecontenttypes",constructor:function(){this.contentTypeStore=this.contentTypeStore||_6.resolve("epi.storeregistry").get("epi.cms.contenttype");},getAcceptedChildTypes:function(_8,_9,_a,_b,_c){var _d=this.contentTypeStore.query({query:this._getavailabletypesQuery,localAsset:_9,parentReference:_8,requestedTypes:_a});return this.filterQueryResult(_d,_b,_c);},filterQueryResult:function(_e,_f,_10){return _4(_e).then(function(_11){var _12=_2.map(_11,function(_13){return _13.typeIdentifier;});_12=_7.getValidAcceptedTypes(_12,_f,_10);_11=_2.filter(_11,function(_14){return _2.some(_12,function(_15){return _14.typeIdentifier===_15;});});return _11;});}});});