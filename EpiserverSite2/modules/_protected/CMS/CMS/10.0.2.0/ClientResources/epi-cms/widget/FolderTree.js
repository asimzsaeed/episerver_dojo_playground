//>>built
define("epi-cms/widget/FolderTree",["dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/dom-attr","dojo/dom-class","dojo/aspect","dojo/json","dojo/when","dojox/html/entities","dijit/tree/_dndSelector","epi/dependency","epi/string","epi-cms/widget/_FolderTreeNode","epi-cms/widget/ContentTree","epi-cms/widget/ContentTreeStoreModel"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f){return _2([_e],{handleSelection:true,postCreate:function(){var _10=this;_10.inherited(arguments);_10.own(_10.connect(_10.model,"onDeleted",_3.hitch(_10,_10._onDeleted)),_6.around(_10.model,"onRefreshRoots",function(_11){return function(_12){if(_12&&typeof _10._onItemDelete==="function"){_10._onItemDelete(_12);}return _11.apply(_10.model,[_12]);};}));},toggleCut:function(_13,_14){var _15=this.tree.getNodesByItem(_13)[0];if(_15){_5.toggle(_15.rowNode,"epi-opacity50",_14);}},_createTreeModel:function(){return new _f({store:this.store});},_updateItemDeletedHierachy:function(_16){if(!_16){return;}_1.forEach(_16.getChildren(),function(_17){_17.set({item:_3.mixin(_17.item,{isDeleted:true})});this._updateItemDeletedHierachy(_17);},this);},_onDeleted:function(_18){var _19=this.getNodesByItem(_18);_1.forEach(_19,function(_1a){this._updateItemDeletedHierachy(_1a);},this);},_renameFolder:function(_1b,_1c){var _1d=_3.trim(_1c),_1e=this.getNodesByItem(_1b)[0];if(_1d){_8(this.model.rename(_1b.contentLink,_1d)).otherwise(function(ex){_1e.rollbackLabel(_1b.name,ex);_1e.edit();});}else{_1e.rollbackLabel(_1b.name);}},buildNodeFromTemplate:function(_1f){var _20=new _d(_1f);_20.bindContextMenu(this.contextMenu);this.own(_20.on("rename",_3.hitch(this,function(val){this._renameFolder(_20.item,val);})));return _20;},_onNodeMouseEnter:function(_21,evt){this.inherited(arguments);_21._handleMouseEnter();},_onNodeMouseLeave:function(_22,evt){this.inherited(arguments);_22._handleMouseLeave();},_onClick:function(_23,evt){this.inherited(arguments);_23._onClick();}});});