function init(){var e,t,n,i,o,a,r,l,s=document.forms.fullpage,d=s.elements,c=tinyMCEPopup.editor,u=tinyMCEPopup.dom;for(i=c.getParam("fullpage_doctypes",defaultDocTypes).split(","),t=0;i.length>t;t++)n=i[t].split("="),n.length>1&&addSelectValue(s,"doctypes",n[0],n[1]);for(r=c.getParam("fullpage_fonts",defaultFontNames).split(";"),t=0;r.length>t;t++)n=r[t].split("="),n.length>1&&addSelectValue(s,"fontface",n[0],n[1]);for(r=c.getParam("fullpage_fontsizes",defaultFontSizes).split(","),t=0;r.length>t;t++)addSelectValue(s,"fontsize",r[t],r[t]);for(a=c.getParam("fullpage_media_types",defaultMediaTypes).split(","),t=0;a.length>t;t++)n=a[t].split("="),n.length>1&&(addSelectValue(s,"element_style_media",n[0],n[1]),addSelectValue(s,"element_link_media",n[0],n[1]));for(o=c.getParam("fullpage_encodings",defaultEncodings).split(","),t=0;o.length>t;t++)n=o[t].split("="),n.length>1&&(addSelectValue(s,"docencoding",n[0],n[1]),addSelectValue(s,"element_script_charset",n[0],n[1]),addSelectValue(s,"element_link_charset",n[0],n[1]));document.getElementById("bgcolor_pickcontainer").innerHTML=getColorPickerHTML("bgcolor_pick","bgcolor"),document.getElementById("link_color_pickcontainer").innerHTML=getColorPickerHTML("link_color_pick","link_color"),document.getElementById("visited_color_pickcontainer").innerHTML=getColorPickerHTML("visited_color_pick","visited_color"),document.getElementById("active_color_pickcontainer").innerHTML=getColorPickerHTML("active_color_pick","active_color"),document.getElementById("textcolor_pickcontainer").innerHTML=getColorPickerHTML("textcolor_pick","textcolor"),document.getElementById("stylesheet_browsercontainer").innerHTML=getBrowserHTML("stylesheetbrowser","stylesheet","file","fullpage"),document.getElementById("link_href_pickcontainer").innerHTML=getBrowserHTML("link_href_browser","element_link_href","file","fullpage"),document.getElementById("script_src_pickcontainer").innerHTML=getBrowserHTML("script_src_browser","element_script_src","file","fullpage"),document.getElementById("bgimage_pickcontainer").innerHTML=getBrowserHTML("bgimage_browser","bgimage","image","fullpage"),isVisible("stylesheetbrowser")&&(document.getElementById("stylesheet").style.width="220px"),isVisible("link_href_browser")&&(document.getElementById("element_link_href").style.width="230px"),isVisible("bgimage_browser")&&(document.getElementById("bgimage").style.width="210px"),u.add(document.body,"iframe",{id:"documentIframe",src:'javascript:""',style:{display:"none"}}),doc=u.get("documentIframe").contentWindow.document,h=tinyMCEPopup.getWindowArg("head_html"),h=h.replace(/<script>/gi,'<script type="text/javascript">'),h=h.replace(/type=([\"\'])?/gi,"type=$1-mce-"),h=h.replace(/(src=|href=)/g,"_mce_$1"),doc.write(h+"</body></html>"),doc.close(),xmlVer=getReItem(/<\?\s*?xml.*?version\s*?=\s*?"(.*?)".*?\?>/gi,h,1),xmlEnc=getReItem(/<\?\s*?xml.*?encoding\s*?=\s*?"(.*?)".*?\?>/gi,h,1),docType=getReItem(/<\!DOCTYPE.*?>/gi,h.replace(/\n/g,""),0).replace(/ +/g," "),s.langcode.value=getReItem(/lang="(.*?)"/gi,h,1),(e=doc.getElementsByTagName("title")[0])&&(d.metatitle.value=e.textContent||e.text),tinymce.each(doc.getElementsByTagName("meta"),function(t){var n=(t.getAttribute("name",2)||"").toLowerCase(),i=t.getAttribute("content",2),o=t.getAttribute("httpEquiv",2)||"";if(e=d["meta"+n],"robots"==n)return selectByValue(s,"metarobots",tinymce.trim(i),!0,!0),void 0;switch(o.toLowerCase()){case"content-type":return tmp=getReItem(/charset\s*=\s*(.*)\s*/gi,i,1),""!=tmp&&(xmlEnc=tmp),void 0}e&&(e.value=i)}),selectByValue(s,"doctypes",docType,!0,!0),selectByValue(s,"docencoding",xmlEnc,!0,!0),selectByValue(s,"langdir",doc.body.getAttribute("dir",2)||"",!0,!0),""!=xmlVer&&(d.xml_pi.checked=!0),tinymce.each(doc.getElementsByTagName("link"),function(e){var t=e.getAttribute("media",2)||"",n=e.getAttribute("type",2)||"";return"-mce-text/css"!=n||""!=t&&"screen"!=t&&"all"!=t||"stylesheet"!=(e.getAttribute("rel",2)||"")?void 0:(s.stylesheet.value=e.getAttribute("_mce_href",2)||"",!1)}),tinymce.each(doc.getElementsByTagName("style"),function(e){var t=parseStyleElement(e);for(x=0;t.length>x;x++)-1!=t[x].rule.indexOf("a:visited")&&t[x].data.color&&(s.visited_color.value=t[x].data.color),-1!=t[x].rule.indexOf("a:link")&&t[x].data.color&&(s.link_color.value=t[x].data.color),-1!=t[x].rule.indexOf("a:active")&&t[x].data.color&&(s.active_color.value=t[x].data.color)}),s.textcolor.value=tinyMCEPopup.dom.getAttrib(doc.body,"text"),s.active_color.value=tinyMCEPopup.dom.getAttrib(doc.body,"alink"),s.link_color.value=tinyMCEPopup.dom.getAttrib(doc.body,"link"),s.visited_color.value=tinyMCEPopup.dom.getAttrib(doc.body,"vlink"),s.bgcolor.value=tinyMCEPopup.dom.getAttrib(doc.body,"bgcolor"),s.bgimage.value=tinyMCEPopup.dom.getAttrib(doc.body,"background"),l=tinyMCEPopup.dom.parseStyle(tinyMCEPopup.dom.getAttrib(doc.body,"style")),l["font-family"]?selectByValue(s,"fontface",l["font-family"],!0,!0):selectByValue(s,"fontface",c.getParam("fullpage_default_fontface",""),!0,!0),l["font-size"]?selectByValue(s,"fontsize",l["font-size"],!0,!0):selectByValue(s,"fontsize",c.getParam("fullpage_default_fontsize",""),!0,!0),l.color&&(s.textcolor.value=convertRGBToHex(l.color)),l["background-image"]&&(s.bgimage.value=l["background-image"].replace(RegExp("url\\('?([^']*)'?\\)","gi"),"$1")),l["background-color"]&&(s.bgcolor.value=l["background-color"]),l.margin&&(tmp=l.margin.replace(/[^0-9 ]/g,""),tmp=tmp.split(/ +/),s.topmargin.value=tmp.length>0?tmp[0]:"",s.rightmargin.value=tmp.length>1?tmp[1]:tmp[0],s.bottommargin.value=tmp.length>2?tmp[2]:tmp[0],s.leftmargin.value=tmp.length>3?tmp[3]:tmp[0]),l["margin-left"]&&(s.leftmargin.value=l["margin-left"].replace(/[^0-9]/g,"")),l["margin-right"]&&(s.rightmargin.value=l["margin-right"].replace(/[^0-9]/g,"")),l["margin-top"]&&(s.topmargin.value=l["margin-top"].replace(/[^0-9]/g,"")),l["margin-bottom"]&&(s.bottommargin.value=l["margin-bottom"].replace(/[^0-9]/g,"")),s.style.value=tinyMCEPopup.dom.serializeStyle(l),updateColor("textcolor_pick","textcolor"),updateColor("bgcolor_pick","bgcolor"),updateColor("visited_color_pick","visited_color"),updateColor("active_color_pick","active_color"),updateColor("link_color_pick","link_color")}function getReItem(e,t,n){var i=e.exec(t);return i&&i.length>n?i[n]:""}function updateAction(){var e,t,n,i,o,a,r,l,s,d,c=document.forms[0],u=!0;for(a=doc.getElementsByTagName("head")[0],e=doc.getElementsByTagName("script"),t=0;e.length>t;t++)""==tinyMCEPopup.dom.getAttrib(e[t],"_mce_type")&&e[t].setAttribute("_mce_type","text/javascript");for(e=doc.getElementsByTagName("link"),t=0;e.length>t;t++)if(l=e[t],s=tinyMCEPopup.dom.getAttrib(l,"media"),"text/css"==tinyMCEPopup.dom.getAttrib(l,"_mce_type")&&(""==s||"screen"==s||"all"==s)&&"stylesheet"==tinyMCEPopup.dom.getAttrib(l,"rel")){u=!1,""==c.stylesheet.value?l.parentNode.removeChild(l):l.setAttribute("_mce_href",c.stylesheet.value);break}""!=c.stylesheet.value&&(l=doc.createElement("link"),l.setAttribute("type","text/css"),l.setAttribute("_mce_href",c.stylesheet.value),l.setAttribute("rel","stylesheet"),a.appendChild(l)),setMeta(a,"keywords",c.metakeywords.value),setMeta(a,"description",c.metadescription.value),setMeta(a,"author",c.metaauthor.value),setMeta(a,"copyright",c.metacopyright.value),setMeta(a,"robots",getSelectValue(c,"metarobots")),setMeta(a,"Content-Type",getSelectValue(c,"docencoding")),doc.body.dir=getSelectValue(c,"langdir"),doc.body.style.cssText=c.style.value,doc.body.setAttribute("vLink",c.visited_color.value),doc.body.setAttribute("link",c.link_color.value),doc.body.setAttribute("text",c.textcolor.value),doc.body.setAttribute("aLink",c.active_color.value),doc.body.style.fontFamily=getSelectValue(c,"fontface"),doc.body.style.fontSize=getSelectValue(c,"fontsize"),doc.body.style.backgroundColor=c.bgcolor.value,""!=c.leftmargin.value&&(doc.body.style.marginLeft=c.leftmargin.value+"px"),""!=c.rightmargin.value&&(doc.body.style.marginRight=c.rightmargin.value+"px"),""!=c.bottommargin.value&&(doc.body.style.marginBottom=c.bottommargin.value+"px"),""!=c.topmargin.value&&(doc.body.style.marginTop=c.topmargin.value+"px"),r=doc.getElementsByTagName("html")[0],r.setAttribute("lang",c.langcode.value),r.setAttribute("xml:lang",c.langcode.value),doc.body.style.backgroundImage=""!=c.bgimage.value?"url('"+c.bgimage.value+"')":"",d=tinyMCEPopup.editor.plugins.fullpage._createSerializer(),d.setRules("-title,meta[http-equiv|name|content],base[href|target],link[href|rel|type|title|media],style[type],script[type|language|src],html[lang|xml::lang|xmlns],body[style|dir|vlink|link|text|alink],head"),n=d.serialize(doc.documentElement),n=n.substring(0,n.lastIndexOf("</body>")),n=-1==n.indexOf("<title>")?n.replace(/<head.*?>/,"$&\n<title>"+tinyMCEPopup.dom.encode(c.metatitle.value)+"</title>"):n.replace(/<title>(.*?)<\/title>/,"<title>"+tinyMCEPopup.dom.encode(c.metatitle.value)+"</title>"),""!=(i=getSelectValue(c,"doctypes"))&&(n=i+"\n"+n),c.xml_pi.checked&&(o='<?xml version="1.0"',""!=(i=getSelectValue(c,"docencoding"))&&(o+=' encoding="'+i+'"'),o+="?>\n",n=o+n),n=n.replace(/type=\"\-mce\-/gi,'type="'),tinyMCEPopup.editor.plugins.fullpage.head=n,tinyMCEPopup.editor.plugins.fullpage._setBodyAttribs(tinyMCEPopup.editor,{}),tinyMCEPopup.close()}function changedStyleField(){}function setMeta(e,t,n){var i,o,a;for(i=e.getElementsByTagName("meta"),o=0;i.length>o;o++){if("Content-Type"==t&&tinyMCEPopup.dom.getAttrib(i[o],"http-equiv")==t)return""==n?i[o].parentNode.removeChild(i[o]):i[o].setAttribute("content","text/html; charset="+n),void 0;if(tinyMCEPopup.dom.getAttrib(i[o],"name")==t)return""==n?i[o].parentNode.removeChild(i[o]):i[o].setAttribute("content",n),void 0}""!=n&&(a=doc.createElement("meta"),"Content-Type"==t?a.httpEquiv=t:a.setAttribute("name",t),a.setAttribute("content",n),e.appendChild(a))}function parseStyleElement(e){var t,n,i,o=e.innerHTML;for(o=o.replace(/<!--/gi,""),o=o.replace(/-->/gi,""),o=o.replace(/[\n\r]/gi,""),o=o.replace(/\s+/gi," "),i=[],t=o.split(/{|}/),n=0;t.length>n;n+=2)""!=t[n]&&(i[i.length]={rule:tinymce.trim(t[n]),data:tinyMCEPopup.dom.parseStyle(t[n+1])});return i}function serializeStyleElement(e){var t,n,i;for(n="<!--\n",t=0;e.length>t;t++)n+=e[t].rule+" {\n",i=tinyMCE.serializeStyle(e[t].data),""!=i&&(i+=";"),n+=i.replace(/;/g,";\n"),n+="}\n",t!=e.length-1&&(n+="\n");return n+="\n-->"}tinyMCEPopup.requireLangPack();var doc,defaultDocTypes='XHTML 1.0 Transitional=<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">,XHTML 1.0 Frameset=<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd">,XHTML 1.0 Strict=<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">,XHTML 1.1=<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">,HTML 4.01 Transitional=<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">,HTML 4.01 Strict=<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">,HTML 4.01 Frameset=<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN" "http://www.w3.org/TR/html4/frameset.dtd">',defaultEncodings="Western european (iso-8859-1)=iso-8859-1,Central European (iso-8859-2)=iso-8859-2,Unicode (UTF-8)=utf-8,Chinese traditional (Big5)=big5,Cyrillic (iso-8859-5)=iso-8859-5,Japanese (iso-2022-jp)=iso-2022-jp,Greek (iso-8859-7)=iso-8859-7,Korean (iso-2022-kr)=iso-2022-kr,ASCII (us-ascii)=us-ascii",defaultMediaTypes="all=all,screen=screen,print=print,tty=tty,tv=tv,projection=projection,handheld=handheld,braille=braille,aural=aural",defaultFontNames="Arial=arial,helvetica,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,times new roman,times,serif;Tahoma=tahoma,arial,helvetica,sans-serif;Times New Roman=times new roman,times,serif;Verdana=verdana,arial,helvetica,sans-serif;Impact=impact;WingDings=wingdings",defaultFontSizes="10px,11px,12px,13px,14px,15px,16px";tinyMCEPopup.onInit.add(init);