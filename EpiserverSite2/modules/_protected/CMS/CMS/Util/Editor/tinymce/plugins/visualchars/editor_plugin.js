(function(){tinymce.create("tinymce.plugins.VisualChars",{init:function(e){var t=this;t.editor=e,e.addCommand("mceVisualChars",t._toggleVisualChars,t),e.addButton("visualchars",{title:"visualchars.desc",cmd:"mceVisualChars"}),e.onBeforeGetContent.add(function(e,n){t.state&&"raw"!=n.format&&!n.draft&&(t.state=!0,t._toggleVisualChars(!1))})},getInfo:function(){return{longname:"Visual characters",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/visualchars",version:tinymce.majorVersion+"."+tinymce.minorVersion}},_toggleVisualChars:function(e){var t,n,i,o,a,l=this,r=l.editor,s=(r.getDoc(),r.getBody()),c=r.selection;if(l.state=!l.state,r.controlManager.setActive("visualchars",l.state),e&&(a=c.getBookmark()),l.state)for(t=[],tinymce.walk(s,function(e){3==e.nodeType&&e.nodeValue&&-1!=e.nodeValue.indexOf("Â ")&&t.push(e)},"childNodes"),n=0;t.length>n;n++){for(i=t[n].nodeValue,i=i.replace(/(\u00a0)/g,'<span _mce_bogus="1" class="mceItemHidden mceItemNbsp">$1</span>'),o=r.dom.create("div",null,i);node=o.lastChild;)r.dom.insertAfter(node,t[n]);r.dom.remove(t[n])}else for(t=r.dom.select("span.mceItemNbsp",s),n=t.length-1;n>=0;n--)r.dom.remove(t[n],1);c.moveToBookmark(a)}}),tinymce.PluginManager.add("visualchars",tinymce.plugins.VisualChars)})();