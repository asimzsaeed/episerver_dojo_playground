//>>built
define("epi/Url",["dojo/_base/declare","dojo/_base/lang","dojo/io-query"],function(_1,_2,_3){var _4,_5={strict:1,loose:2},_6=new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?$");_4=_1(null,{scheme:null,authority:null,path:null,query:null,fragment:null,queryParseMode:_5.loose,_undecodeable:null,constructor:function(_7,_8,_9,_a){var _b;this._undecodeable=[];this.queryParseMode=_a||this.queryParseMode;_b=this._extractParameters(_7);if(_9&&_8&&_8.query){_8.query=_2.mixin(_b.query,_8.query);}_1.safeMixin(this,_2.mixin(_b,_8));},_extractParameters:function(_c){var r,_d,_e;if(!_c){return {};}r=_c.match(_6);_d=r[7]||(r[6]?"":null);_e=this._withQueryParseMode(function(){return _d?_3.queryToObject(_d):{};});return {scheme:r[2]||(r[1]?"":null),authority:r[4]||(r[3]?"":null),path:r[5],query:_e,fragment:r[9]||(r[8]?"":null)};},getQueryParameterValue:function(_f){return this.query?this.query[_f]:undefined;},toString:function(){var url=[],_10=this.query,_11;if(this.scheme){url.push(this.scheme);if(this.scheme.lastIndexOf(":")!==this.scheme.length-1){url.push(":");}}if(this.authority){url.push("//",this.authority);}url.push(this.path);if(_10){_11=this._withQueryParseMode(function(){return _3.objectToQuery(_10);});if(_11!==""){url.push("?",_11);}}if(this.fragment){url.push("#",this.fragment);}return url.join("");},_withQueryParseMode:function(_12){var _13,_14=this._undecodeable,_15=this.queryParseMode===_4.parseMode.loose,_16=encodeURIComponent,_17=decodeURIComponent;function _18(_19){if(_14.indexOf(_19)!==-1){return _19;}else{return _16(_19);}};function _1a(_1b){var _1c=_1b;try{_1b=_17(_1b);}catch(ex){_14.push(_1b);}return _1b;};if(_15){window["encodeURIComponent"]=_18;window["decodeURIComponent"]=_1a;try{_13=_12();}finally{window["encodeURIComponent"]=_16;window["decodeURIComponent"]=_17;}}else{_13=_12();}return _13;}});_4.parseMode=_5;return _4;});