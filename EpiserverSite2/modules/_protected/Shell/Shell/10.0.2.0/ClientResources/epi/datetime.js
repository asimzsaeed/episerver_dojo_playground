//>>built
define("epi/datetime",["epi","dojo/date","dojo/date/stamp","dojo/date/locale","dojo/_base/lang","dojo/_base/kernel","dojo/i18n"],function(_1,_2,_3,_4,_5,_6,_7){function _8(_9,_a){var _b=_1.resources.text.day;var _c=_1.resources.text.days;var _d=_1.resources.text.hour;var _e=_1.resources.text.hours;var _f=_1.resources.text.minute;var _10=_1.resources.text.minutes;var _11=_1.resources.text.second;var _12=_1.resources.text.seconds;var _13="";var _14=_a-_9;if(_14<0){return " 1 "+_11;}var _15=Math.floor(_14/1000/60/60/24);var _16=new Date(_14);var _17=_16.getUTCHours();var _18=_16.getMinutes();var _19=_16.getSeconds();if(_15!==0){_13=_13+" "+_15+" "+(_15>1?_c:_b);}if(_17!==0){_13=_13+" "+_17+" "+(_17>1?_e:_d);}if(_18!==0){_13=_13+" "+_18+" "+(_18>1?_10:_f);}if(_13.length>0){return _13;}return " "+_19+" "+(_19>1?_12:_11);};function _1a(obj){if(_5.isObject(obj)){for(var _1b in obj){return true;}}return false;};function _1c(obj,_1d){if(_1d){if(obj instanceof Date){return _3.toISOString(obj,{zulu:true});}else{return obj;}}var _1e=_5.clone(obj);for(var _1f in obj){if(obj[_1f] instanceof Date){_1e[_1f]=_3.toISOString(obj[_1f],{zulu:true});}else{if(_1a(obj[_1f])){_1e[_1f]=_1c(obj[_1f]);}}}return _1e;};function _20(_21){return "'"+_21+"'";};return _1.datetime={serverTimeDelta:0,deserialize:function(_22){_6.deprecated("epi/datetime","Use Date.parse(dateString) or new Date(dateString)","10.0");var _23=/((?:\d{4})-(?:0[1-9]|1[012])-(?:0[1-9]|[12][0-9]|3[01])T(?:[01][0-9]|2[0123]):(?:[0-5][0-9])(?::(?:[0-5][0-9])(?:.\d+)?)?(?:(?:[+-](?:\d{2}):(?:[0-5][0-9]))|Z))/gi;if(!_22){return null;}else{if(_22.match&&_22.match(_23)){var _24=_3.fromISOString(_22.match(_23)[0]);return _24;}else{throw "Invalid JSON date";}}},serialize:function(_25){_6.deprecated("epi/datetime","Use Date.prototype.toISOString()","10.0");return _3.toISOString(_25);},transformDate:function(_26){var _27=(_1a(_26)&&!(_26 instanceof Date));var _28=(_27?_1c(_26):_1c(_26,true));return _28;},isDateValid:function(obj){return ((obj&&obj instanceof Date)&&(!isNaN(obj.getTime())));},toUserFriendlyString:function(_29,_2a,_2b,_2c){if(!_29){return "";}if(typeof _29==="string"){var _2d=new Date(_29);if(!isNaN(_2d)){_29=_2d;}}if(!(_29 instanceof Date)){_29=this.deserialize(_29);}var _2e=_7.getLocalization("dojo.cldr","gregorian",_2a);var _2f=new Date(),_30=new Date(_29),_31=_2c?"date":"",_32="";_2f.setHours(0,0,0,0);_30.setHours(0,0,0,0);if(_2.difference(_2f,_29,"year")===0){_32=_2e["dateFormatItem-MMMd"];var _33=_2.difference(_2f,_30,"day");switch(_33){case 0:if(_2b){return _4.format(_29,{selector:"time",locale:_2a});}_32=_20(_2e["field-day-relative+0"]);break;case 1:_32=_20(_2e["field-day-relative+1"]);break;case -1:_32=_20(_2e["field-day-relative+-1"]);break;}}return _4.format(_29,{selector:_31,datePattern:_32,locale:_2a});},toUserFriendlyHtml:function(_34,_35,_36,_37){var _38=this.toUserFriendlyString(_34,_35,_36,_37);if(_38===""){return _38;}return "<span class='epi-timestamp'>"+_38+"</span>";},timePassed:function(_39,to){to=to||new Date();return _8(_39,to);},timeToGo:function(_3a){return _8(this.serverTime(),_3a);},serverTime:function(){return new Date(new Date().getTime()+this.serverTimeDelta);}};});