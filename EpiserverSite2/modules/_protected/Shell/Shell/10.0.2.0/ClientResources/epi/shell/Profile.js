//>>built
define("epi/shell/Profile",["dojo/_base/declare","dojo/_base/lang","dojo/json","dojo/Evented","dojo/Deferred","dojo/store/Cache","dojo/store/Memory","dojo/when","epi/routes","epi/shell/store/JsonRest","epi/shell/store/Throttle"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b){return _1([_4],{_store:null,constructor:function(_c){_1.safeMixin(this,_c);if(!this._store){var _d=new _a({target:_9.getRestPath({moduleArea:"shell",storeName:"profile"}),defaultRequestParams:{preventLocalizationHeader:true,isProfileRequest:true},preventCache:true});this._store=_6(_b(_d,"get"),new _7());}_8(this._store.get("userName"),_2.hitch(this,function(_e){this.userName=_e.value;}));},get:function(_f){var _10=sessionStorage[_f];if(!_10){_10=localStorage[_f];}if(_10){return _3.parse(_10);}if(_f==="userName"){return this.userName;}return _8(this._store.get(_f),function(obj){return (obj&&obj.value)||null;},function(){return null;});},set:function(_11,_12,_13){var _14=_3.stringify(_12);if(_13&&_13.location){switch(_13.location){case "session":sessionStorage[_11]=_14;this._emitChangedEvent(_11,_12);return _14;case "server":var _15=new _5();_8(this._store.put({id:_11,value:_12}),_2.hitch(this,function(){this._emitChangedEvent(_11,_12);_15.resolve();}),_15.reject);return _15;default:throw "You need to specify a valid location ('session' or 'server').";}}localStorage[_11]=_14;this._emitChangedEvent(_11,_12);return _14;},_emitChangedEvent:function(_16,_17){this.emit("changed",{property:_16,value:_17});}});});