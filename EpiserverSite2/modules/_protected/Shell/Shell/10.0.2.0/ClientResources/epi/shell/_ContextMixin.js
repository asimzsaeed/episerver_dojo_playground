//>>built
define("epi/shell/_ContextMixin",["dojo/_base/declare","dojo/_base/lang","dojo/Deferred","dojo/topic","dijit/Destroyable"],function(_1,_2,_3,_4,_5){return _1([_5],{_currentContext:null,_waitingForContext:null,constructor:function(_6){var _7;function _8(_9,_a){if(this._currentContext||!_a||_a.sender!==this){return;}_7.remove();_7=null;this._initialContextChanged(_9);};this.own(_4.subscribe("/epi/shell/context/request",_2.hitch(this,this._contextRequest)),_4.subscribe("/epi/shell/context/changed",_2.hitch(this,this._contextChanged)),_4.subscribe("/epi/shell/context/updated",_2.hitch(this,this._contextUpdated)),_4.subscribe("/epi/shell/context/requestfailed",_2.hitch(this,this._contextFailed)),_7=_4.subscribe("/epi/shell/context/current",_2.hitch(this,_8)));_4.publish("/epi/shell/context/requestcurrent",{sender:this});},getCurrentContext:function(){if(this._currentContext!==null){return this._currentContext;}if(!this._waitingForContext){this._waitingForContext=new _3();}return this._waitingForContext.promise;},contextChanged:function(_b,_c){},contextUpdated:function(_d,_e){},contextChangeFailed:function(_f,_10){},_contextChanged:function(ctx,_11){if(!this._currentContext){this._initialContextChanged(ctx);}this._currentContext=ctx;this.contextChanged(ctx,_11);},_initialContextChanged:function(_12,_13){this._currentContext=_12;if(this._waitingForContext){this._waitingForContext.resolve(_12);this._waitingForContext=null;}},_contextRequest:function(){this._currentContext=null;},_contextUpdated:function(ctx,_14){this._currentContext=ctx;this.contextUpdated(ctx,_14);},_contextFailed:function(ctx,_15){if(!this._currentContext){this._initialContextChanged(ctx);}this._currentContext=ctx;this.contextChangeFailed(ctx,_15);}});});