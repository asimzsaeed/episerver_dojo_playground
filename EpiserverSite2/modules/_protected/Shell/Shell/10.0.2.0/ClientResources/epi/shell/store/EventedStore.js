//>>built
define("epi/shell/store/EventedStore",["dojo/Evented","dojo/when"],function(_1,_2){return function(_3){var _4=new _1();_3.emit=_4.emit.bind(_4);_3.on=_4.on.bind(_4);var _5;function _6(_7,_8){var _9=_3[_7];if(_9){_3[_7]=function(){var _a=arguments;if(_5){return _9.apply(this,_a);}_5=true;try{var _b=_9.apply(this,_a);_2(_b).then(function(_c){_8(_c,_a);});return _b;}finally{_5=false;}};}};function _d(_e){return function(_f){_2(_f).then(function(_10){_3.emit(_e,{target:_10});});return _f;};};function _11(_12){return function(_13,_14){_2(_13).then(function(){_3.emit(_12,{id:_14[0]});});return _13;};};_6("add",_d("update"));_6("put",_d("update"));_6("refresh",_d("update"));_6("remove",_11("delete"));_6("evict",_11("delete"));return _3;};});