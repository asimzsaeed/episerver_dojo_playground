//>>built
define("epi/shell/widget/overlay/OverlayContainer",["dojo/_base/array","dojo/_base/declare","dojo/_base/Deferred","dojo/_base/lang","dojo/dom-style","dijit/_Container","dijit/_WidgetBase","dijit/_TemplatedMixin","epi/shell/postMessage"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9){return _2([_7,_6,_8],{updateInterval:250,enabled:false,target:null,targetCoverEnabled:false,templateString:"<div data-dojo-attach-point=\"containerNode\" class=\"epi-overlay-container\"><div data-dojo-attach-point=\"targetCover\" class=\"epi-overlay-targetCover\"></div></div>",startup:function(){if(this._started){return;}this.inherited(arguments);this._toggleTargetCover(this.enabled);this.subscribe("/dnd/start",function(){this.set("targetCoverEnabled",true);});this.subscribe("/dnd/cancel",function(){this.set("targetCoverEnabled",false);});this.subscribe("/dnd/drop",function(){this.set("targetCoverEnabled",false);});this.connect(this.target,"onUnload",this.disconnectOverlayItems);this.connect(this.target,"onAfterResize",this._onAfterResizeHandler);},addChild:function(_a,_b){this.inherited(arguments);_a.set("parent",this);_a.resize();if(_a.onResize){_a.own(_a.on("resize",this._onContentChange.bind(this)));}},disconnectOverlayItems:function(){this.set("enabled",false);_1.forEach(this.getChildren(),_4.hitch(this,function(_c){_c.set("sourceItemNode",null);}));},_setReadOnlyAttr:function(_d){this._set("readOnly",_d);_1.forEach(this.getChildren(),_4.hitch(this,function(_e){_e.set("readOnly",_d);}));},_onAfterResizeHandler:function(_f){this.set("documentSize",_f);this._updateOverlayItems(true);},_onContentChange:function(){this.target.contentChange();},_updateOverlayItems:function(_10){if(!this.get("enabled")||this.isUpdating||!this.target.isInspectable()){return;}var _11=4;var _12=1;var _13;var _14;this.isUpdating=true;do{_13=false;_1.forEach(this.getChildren(),function(_15){var _16=_15.get("position");_14=_16.isChanged||_14;if(_16.isChanged){_13=_15.updatePosition(_16)||_13;}},this);}while(_13&&_12++<_11);this.isUpdating=false;if(_12>=2||!_10&&_14){this.target.contentChange();}else{if(!_10){this.target.checkSize();}}},_toggleTargetCover:function(_17){var _18=this.get("documentSize");if(_17&&_18){_5.set(this.targetCover,{width:(_18.w)+"px",height:(_18.h)+"px"});}_5.set(this.targetCover,{display:_17?"block":"none"});},_togglePoller:function(_19){var _1a=this;function _1b(){_1a._updateOverlayItems();if(_1a.updateInterval>0){_1a._pollerToken=setTimeout(_1b,_1a.updateInterval);}};if(_1a._pollerToken){clearTimeout(_1a._pollerToken);}if(_19){_1b();}},_setUpdateIntervalAttr:function(_1c){this._set("updateInterval",_1c);this._togglePoller(_1c>0);},_setEnabledAttr:function(_1d){this._set("enabled",_1d);if(_1d){this._updateOverlayItems();}_1.forEach(this.getChildren(),function(w){w.set("disabled",!_1d);},this);this._togglePoller(_1d);_5.set(this.domNode,{display:_1d?"":"none"});},_setTargetCoverEnabledAttr:function(_1e){if(this.targetCoverEnabled===_1e){return;}this._toggleTargetCover(_1e);this._set("targetCoverEnabled",_1e);}});});