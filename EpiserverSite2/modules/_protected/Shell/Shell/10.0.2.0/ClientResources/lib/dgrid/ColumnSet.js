//>>built
define("dgrid/ColumnSet",["dojo/_base/kernel","dojo/_base/declare","dojo/_base/lang","dojo/_base/Deferred","dojo/on","dojo/aspect","dojo/query","dojo/has","./util/misc","put-selector/put","xstyle/has-class","./Grid","dojo/_base/sniff","xstyle/css!./css/columnset.css"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c){_8.add("event-mousewheel",function(_d,_e,_f){return typeof _f.onmousewheel!=="undefined";});_8.add("event-wheel",function(_10,_11,_12){var _13=false;try{WheelEvent("wheel");_13=true;}catch(e){}return _13;});var _14="data-dgrid-column-set-id";_b("safari","ie-7");function _15(_16,row){var _17=_16._columnSetScrollLefts;function _18(){_7(".dgrid-column-set",row).forEach(function(_19){_19.scrollLeft=_17[_19.getAttribute(_14)];});};if(_8("ie")<8||_8("quirks")){setTimeout(_18,1);}else{_18();}};function _1a(_1b,_1c,_1d){var id=_1c.getAttribute(_14);var _1e=_1b._columnSetScrollers[id];_1e.scrollLeft=_1d<0?0:_1d;};function _1f(_20,_21){if(!_20||!_20.length){return;}var _22=[];var _23=_21+"-";for(var i=0,_24=_20.length;i<_24;i++){var row=_20[i];var _25=[];_25.className=row.className;for(var k=0,_26=row.length;k<_26;k++){var _27=row[k];if(_27.id!=null&&_27.id.indexOf(_23)===0){_25.push(_27);}}_22.push(_25);}return _22;};var _28=_8("event-mousewheel")||_8("event-wheel")?function(_29){return function(_2a,_2b){return _5(_2a,_8("event-wheel")?"wheel":"mousewheel",function(_2c){var _2d=_2c.target,_2e;if(_2d.nodeType!==1){_2d=_2d.parentNode;}while(!_7.matches(_2d,".dgrid-column-set["+_14+"]",_2a)){if(_2d===_2a||!(_2d=_2d.parentNode)){return;}}_2e=_2c.deltaX||-_2c.wheelDeltaX/3;if(_2e){_2b.call(null,_29,_2d,_2e);}});};}:function(_2f){return function(_30,_31){return _5(_30,".dgrid-column-set["+_14+"]:MozMousePixelScroll",function(_32){if(_32.axis===1){_31.call(null,_2f,this,_32.detail);}});};};return _2(null,{postCreate:function(){var _33=this;this.inherited(arguments);this.on(_28(this),function(_34,_35,_36){var id=_35.getAttribute(_14),_37=_34._columnSetScrollers[id],_38=_37.scrollLeft+_36;_37.scrollLeft=_38<0?0:_38;});this.on(".dgrid-column-set:dgrid-cellfocusin",function(_39){_33._onColumnSetCellFocus(_39,this);});},columnSets:[],createRowCells:function(tag,_3a,_3b,_3c){var row=_a("table.dgrid-row-table");var tr=_a(row,"tbody tr");for(var i=0,l=this.columnSets.length;i<l;i++){var _3d=_a(tr,tag+".dgrid-column-set-cell.dgrid-column-set-"+i+" div.dgrid-column-set["+_14+"="+i+"]");var _3e=_1f(_3b||this.subRows,i)||this.columnSets[i];_3d.appendChild(this.inherited(arguments,[tag,_3a,_3e,_3c]));}return row;},renderArray:function(){var _3f=this,_40=this.inherited(arguments);_4.when(_40,function(_41){for(var i=0;i<_41.length;i++){_15(_3f,_41[i]);}});return _40;},renderHeader:function(){this.inherited(arguments);var _42=this.columnSets,_43=this.domNode,_44=this._columnSetScrollers,_45=this._columnSetScrollerContents={},_46=this._columnSetScrollLefts={},_47=this,i,l;function _48(){_47._positionScrollers();};if(_44){for(i in _44){_a(_44[i],"!");}}else{_6.after(this,"resize",_48,true);_6.after(this,"styleColumn",_48,true);this._columnSetScrollerNode=_a(this.footerNode,"+div.dgrid-column-set-scroller-container");}_44=this._columnSetScrollers={};for(i=0,l=_42.length;i<l;i++){this._putScroller(_42[i],i);}this._positionScrollers();},styleColumnSet:function(_49,css){var _4a=this.addCssRule("#"+_9.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-set-"+_9.escapeCssIdentifier(_49,"-"),css);this._positionScrollers();return _4a;},_destroyColumns:function(){var _4b=this.columnSets.length,i,j,k,_4c,len,_4d,_4e,_4f;for(i=0;i<_4b;i++){_4d=this.columnSets[i];for(j=0,_4c=_4d.length;j<_4c;j++){_4e=_4d[j];for(k=0,len=_4e.length;k<len;k++){_4f=_4e[k];if(typeof _4f.destroy==="function"){_4f.destroy();}}}}this.inherited(arguments);},configStructure:function(){this.columns={};this.subRows=[];for(var i=0,l=this.columnSets.length;i<l;i++){var _50=this.columnSets[i];for(var j=0;j<_50.length;j++){_50[j]=this._configColumns(i+"-"+j+"-",_50[j]);}}this.inherited(arguments);},_positionScrollers:function(){var _51=this.domNode,_52=this._columnSetScrollers,_53=this._columnSetScrollerContents,_54=this.columnSets,_55=0,_56=0,i,l,_57,_58;for(i=0,l=_54.length;i<l;i++){_57=_7(".dgrid-column-set["+_14+"=\""+i+"\"]",_51)[0];_55=_57.offsetWidth;_58=_57.firstChild.offsetWidth;_53[i].style.width=_58+"px";_52[i].style.width=_55+"px";if(_8("ie")<9){_52[i].style.overflowX=_58>_55?"scroll":"auto";}if(_58>_55){_56++;}}this._columnSetScrollerNode.style.bottom=this.showFooter?this.footerNode.offsetHeight+"px":"0";this.bodyNode.style.bottom=_56?(_8("dom-scrollbar-height")+(_8("ie")?1:0)+"px"):"0";},_putScroller:function(_59,i){var _5a=this._columnSetScrollers[i]=_a(this._columnSetScrollerNode,"span.dgrid-column-set-scroller.dgrid-column-set-scroller-"+i+"["+_14+"="+i+"]");this._columnSetScrollerContents[i]=_a(_5a,"div.dgrid-column-set-scroller-content");_5(_5a,"scroll",_3.hitch(this,"_onColumnSetScroll"));},_onColumnSetScroll:function(evt){var _5b=evt.target.scrollLeft,_5c=evt.target.getAttribute(_14),_5d;if(this._columnSetScrollLefts[_5c]!=_5b){_7(".dgrid-column-set["+_14+"=\""+_5c+"\"],.dgrid-column-set-scroller["+_14+"=\""+_5c+"\"]",this.domNode).forEach(function(_5e,i){_5e.scrollLeft=_5b;if(!i){_5d=_5e.scrollLeft;}});this._columnSetScrollLefts[_5c]=_5d;}},_setColumnSets:function(_5f){this._destroyColumns();this.columnSets=_5f;this._updateColumns();},setColumnSets:function(_60){_1.deprecated("setColumnSets(...)","use set(\"columnSets\", ...) instead","dgrid 0.4");this.set("columnSets",_60);},_onColumnSetCellFocus:function(_61,_62){var _63=_61.target;var _64=_62.getAttribute(_14);var _65=this._columnSetScrollers[_64];var _66=_63.offsetLeft-_65.scrollLeft+_63.offsetWidth;if(_66>_62.offsetWidth||_65.scrollLeft>_63.offsetLeft){_1a(this,_62,_63.offsetLeft);}}});});