//>>built
define("dgrid/extensions/ColumnHider",["dojo/_base/declare","dojo/has","dojo/on","../util/misc","put-selector/put","dojo/i18n!./nls/columnHider","xstyle/css!../css/extensions/ColumnHider.css"],function(_1,_2,_3,_4,_5,_6){var _7,_8,_9=_2("ie"),_a=_9&&_2("quirks"),_b=_9<8||_a?"htmlFor":"for";function _c(cb,_d){return cb.id.substr(_d.id.length+18);};return _1(null,{hiderMenuNode:null,hiderToggleNode:null,i18nColumnHider:_6,_hiderMenuOpened:false,_columnHiderRules:null,_columnHiderCheckboxes:null,_renderHiderMenuEntries:function(){var _e=this.subRows,_f=true,_10,_11,sr,c;delete this._columnHiderFirstCheckbox;for(sr=0,_10=_e.length;sr<_10;sr++){for(c=0,_11=_e[sr].length;c<_11;c++){this._renderHiderMenuEntry(_e[sr][c]);if(_f){_f=false;this._columnHiderFirstCheckbox=this._columnHiderCheckboxes[_e[sr][c].id];}}}},_renderHiderMenuEntry:function(col){var id=col.id,_12=_4.escapeCssIdentifier(id,"-"),div,_13,_14,_15;if(col.hidden){col.hidden=false;this._hideColumn(id);col.hidden=true;}if(col.unhidable){return;}div=_5("div.dgrid-hider-menu-row");_13=this.domNode.id+"-hider-menu-check-"+_12;_14=this._columnHiderCheckboxes[id]=_5(div,"input.dgrid-hider-menu-check.hider-menu-check-"+_12+"[type=checkbox]");_14.id=_13;_15=_5(div,"label.dgrid-hider-menu-label.hider-menu-label-"+_12+"["+_b+"="+_13+"]",col.label||col.field||"");_5(this.hiderMenuNode,div);if(!col.hidden){_14.checked=true;}},renderHeader:function(){var _16=this,_17=this.hiderMenuNode,_18=this.hiderToggleNode,id;function _19(_1a){_1a.stopPropagation();};this.inherited(arguments);if(!_17){_18=this.hiderToggleNode=_5(this.domNode,"button.ui-icon.dgrid-hider-toggle[type=button][aria-label="+this.i18nColumnHider.popupTriggerLabel+"]");this._listeners.push(_3(_18,"click",function(e){_16._toggleColumnHiderMenu(e);}));_17=this.hiderMenuNode=_5("div.dgrid-hider-menu[role=dialog][aria-label="+this.i18nColumnHider.popupLabel+"]");_17.id=this.id+"-hider-menu";this._listeners.push(_3(_17,"keyup",function(e){var _1b=e.charCode||e.keyCode;if(_1b===27){_16._toggleColumnHiderMenu(e);_18.focus();}}));_17.style.display="none";_5(this.domNode,_17);this._listeners.push(_3(_17,".dgrid-hider-menu-check:"+(_9<9||_a?"click":"change"),function(e){_16._updateColumnHiddenState(_c(e.target,_16),!e.target.checked);}));this._listeners.push(_3(_17,"mousedown",_19),_3(_18,"mousedown",_19));if(!_8){_8=_3.pausable(document,"mousedown",function(e){_7&&_7._toggleColumnHiderMenu(e);});_8.pause();}}else{for(id in this._columnHiderRules){this._columnHiderRules[id].remove();}_17.innerHTML="";}this._columnHiderCheckboxes={};this._columnHiderRules={};this._renderHiderMenuEntries();},destroy:function(){this.inherited(arguments);for(var id in this._columnHiderRules){this._columnHiderRules[id].remove();}},left:function(_1c,_1d){return this.right(_1c,-_1d);},right:function(_1e,_1f){if(!_1e.element){_1e=this.cell(_1e);}var _20=this.inherited(arguments),_21=_1e;while(_20.column.hidden){_20=this.inherited(arguments,[_20,_1f>0?1:-1]);if(_21.element===_20.element){return _1e;}_21=_20;}return _20;},isColumnHidden:function(id){return !!this._columnHiderRules[id];},_toggleColumnHiderMenu:function(){var _22=this._hiderMenuOpened,_23=this.hiderMenuNode,_24=this.domNode,_25;_23.style.display=(_22?"none":"");if(_22){_23.style.height="";}else{if(_23.offsetHeight>_24.offsetHeight-12){_23.style.height=(_24.offsetHeight-12)+"px";}(_25=this._columnHiderFirstCheckbox)&&_25.focus();}_8[_22?"pause":"resume"]();_7=_22?null:this;this._hiderMenuOpened=!_22;},_hideColumn:function(id){var _26=this,_27="#"+_4.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-",_28;if(this._columnHiderRules[id]){return;}this._columnHiderRules[id]=_4.addCssRule(_27+_4.escapeCssIdentifier(id,"-"),"display: none;");if((_2("ie")===8||_2("ie")===10)&&!_2("quirks")){_28=_4.addCssRule(".dgrid-row-table","display: inline-table;");window.setTimeout(function(){_28.remove();_26.resize();},0);}},_showColumn:function(id){if(this._columnHiderRules[id]){this._columnHiderRules[id].remove();delete this._columnHiderRules[id];}},_updateColumnHiddenState:function(id,_29){this[_29?"_hideColumn":"_showColumn"](id);this.columns[id].hidden=_29;_3.emit(this.domNode,"dgrid-columnstatechange",{grid:this,column:this.columns[id],hidden:_29,bubbles:true});this.resize();},toggleColumnHiddenState:function(id,_2a){if(typeof _2a==="undefined"){_2a=!this._columnHiderRules[id];}this._updateColumnHiddenState(id,_2a);this._columnHiderCheckboxes[id].checked=!_2a;}});});