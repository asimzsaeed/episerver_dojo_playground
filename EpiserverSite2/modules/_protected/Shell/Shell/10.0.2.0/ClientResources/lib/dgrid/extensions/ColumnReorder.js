//>>built
define("dgrid/extensions/ColumnReorder",["dojo/_base/lang","dojo/_base/declare","dojo/_base/array","dojo/on","dojo/query","dojo/dnd/Source","put-selector/put","xstyle/css!../css/extensions/ColumnReorder.css"],function(_1,_2,_3,on,_4,_5,_6){var _7=/(\d+)(?:-(\d+))?$/;function _8(_9,_a){var _b=_a[2],_c=_9[_b?"columnSets":"subRows"][_a[1]];return _b?_c[_a[2]]:_c;};function _d(_e,_f,_10){if(_f[2]){_e.columnSets[_f[1]][_f[2]]=_10;}else{_e.subRows[_f[1]]=_10;}};function _11(_12){return "dgrid-"+_12+"-";};function _13(_14,_15){return _15.slice(_11(_14).length);};var _16=_2(_5,{copyState:function(){return false;},checkAcceptance:function(_17,_18){return _17==this;},_legalMouseDown:function(evt){return evt.target.className.indexOf("dgrid-resize-handle")>-1?false:this.inherited(arguments);},onDropInternal:function(_19){var _1a=this.grid,_1b=_7.exec(_13(_1a.id,_19[0].getAttribute("dndType"))),_1c=_1b[2]?"columnSets":"subRows",_1d=_8(_1a,_1b),_1e=_1a.columns;this.inherited(arguments);if(!_1b){return;}setTimeout(function(){var _1f=_3.map(_19[0].parentNode.childNodes,function(col){return _1e[col.columnId];}),_20;_d(_1a,_1b,_1f);_20={grid:_1a,subRow:_1f,column:_1e[_19[0].columnId],bubbles:true,cancelable:true,parentType:"dnd"};_20[_1c]=_1a[_1c];if(on.emit(_1a.domNode,"dgrid-columnreorder",_20)){_1a.set(_1c,_1a[_1c]);}else{_d(_1a,_1b,_1d);_1a.renderHeader();if(this._sort&&this._sort.length){this.updateSortArrow(this._sort);}}},0);}});var _21=_2(null,{columnDndConstructor:_16,_initSubRowDnd:function(_22,_23){var _24,c,len,col,th;for(c=0,len=_22.length;c<len;c++){col=_22[c];if(col.reorderable===false){continue;}th=col.headerNode;if(th.tagName!="TH"){th=th.parentNode;}_6(th,".dojoDndItem[dndType="+_23+"]");if(!_24){_24=th.parentNode;}}if(_24){this._columnDndSources.push(new this.columnDndConstructor(_24,{horizontal:true,grid:this}));}},renderHeader:function(){var _25=_11(this.id),_26,cs;this.inherited(arguments);this._columnDndSources=[];if(this.columnSets){for(cs=0,_26=this.columnSets.length;cs<_26;cs++){_3.forEach(this.columnSets[cs],function(_27,sr){this._initSubRowDnd(_27,_25+cs+"-"+sr);},this);}}else{_3.forEach(this.subRows,function(_28,sr){this._initSubRowDnd(_28,_25+sr);},this);}},_destroyColumns:function(){if(this._columnDndSources){_3.forEach(this._columnDndSources,function(_29){_29.destroy();});}this.inherited(arguments);}});_21.ColumnDndSource=_16;return _21;});