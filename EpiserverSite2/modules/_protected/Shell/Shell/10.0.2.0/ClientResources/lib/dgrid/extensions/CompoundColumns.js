//>>built
define("dgrid/extensions/CompoundColumns",["dojo/_base/lang","dojo/_base/declare","dojo/sniff","dojo/query","../util/misc","xstyle/css!../css/extensions/CompoundColumns.css"],function(_1,_2,_3,_4,_5){return _2(null,{configStructure:function(){var _6=(this.subRows&&this.subRows[0])||this.columns,_7=[[]],_8=_7[0],_9=[];_7[0].className="dgrid-spacer-row";function _a(_b,_c,_d,_e){var _f=0,_10=function(){},_11,_12;function _13(_14,i){if(typeof _14==="string"){_14={label:_14};}if(!(_b instanceof Array)&&!_14.field){_14.field=i;}_11=_14.children;_12=_11&&(_14.showChildHeaders!==false);_14.parentColumn=_e;if(_11){if(_14.id==null){_14.id=((_e&&_e.id)||_c-1)+"-"+_8.length;}else{if(_e&&_e.id){_14.id=_e.id+"-"+_14.id;}}}else{_9.push(_14);_8.push(_1.delegate(_14,{renderHeaderCell:_10}));_f++;}if(!_12){_14=_1.delegate(_14,{rowSpan:-_c});}if(_11){_f+=(_14.colSpan=_a(_11,_c+1,_12,_14));}if(_d){(_7[_c]||(_7[_c]=[])).push(_14);}};_5.each(_b,_13,this);return _f;};_a(_6,1,true);var _15=_7.length,i,j,_16,_17;for(i=0;i<_15;i++){_16=_7[i];for(j=0;j<_16.length;j++){_17=_16[j];if(_17.rowSpan<1){_17.rowSpan+=_15;}}}_9=[_9];_9.headerRows=_7;this.subRows=_9;this.inherited(arguments);},renderHeader:function(){var i,_18=this.subRows[0],_19=this.subRows.headerRows[0];this.inherited(arguments);for(i=_18.length;i--;){_18[i].headerNode=_19[i].headerNode;}},_findSortArrowParent:function(_1a){var _1b=this.inherited(arguments),_1c,_1d;if(_1b&&_5.contains(_4(".dgrid-spacer-row",this.headerNode)[0],_1b)){_1c=_1b.columnId||_1b.parentNode.columnId;_1d=_4(".dgrid-column-"+_1c,this.headerNode);return _1d[_1d.length-1];}},_configColumn:function(_1e,_1f,_20,_21){var _22=_1e.parentColumn;if(_22){var id=_1f.indexOf(_21)===0?_1f.substring(_21.length):_1f;_21=_22.id+"-";_1f=_1e.id=_21+id;}this.inherited(arguments,[_1e,_1f,_20,_21]);},cell:function(_23,_24){if(typeof _24!="object"){var _25=this.column(_24);if(_25){_24=_25.id;}}return this.inherited(arguments,[_23,_24]);},column:function(_26){var _27=this.inherited(arguments);if(_27==null&&typeof _26!="object"){var _28="-"+_26,_29=_28.length;for(var _2a in this.columns){if(_2a.indexOf(_28,_2a.length-_29)!==-1){return this.columns[_2a];}}}return _27;},_updateCompoundHiddenStates:function(id,_2b){var _2c=this.columns[id],_2d;if(_2c&&_2c.hidden==_2b){return;}while(_2c&&_2c.parentColumn){_2c=_2c.parentColumn;_2d=_2c.colSpan=_2c.colSpan+(_2b?-1:1);if(_2d){_2c.headerNode.colSpan=_2d;}if(_2d===1&&!_2b){this._showColumn(_2c.id);}else{if(!_2d&&_2b){this._hideColumn(_2c.id);}}}},_hideColumn:function(id){var _2e=this;this._updateCompoundHiddenStates(id,true);this.inherited(arguments);if(_3("ff")){this.headerNode.style.display="none";setTimeout(function(){_2e.headerNode.style.display="";_2e.resize();},0);}},_showColumn:function(id){this._updateCompoundHiddenStates(id,false);this.inherited(arguments);},_getResizedColumnWidths:function(){var _2f=0,_30=this.columns,id;for(id in _30){_2f+=_30[id].headerNode.offsetWidth;}return {totalWidth:_2f,lastColId:this.subRows[0][this.subRows[0].length-1].id};}});});